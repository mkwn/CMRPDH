#LyX 2.1 created this file. For more info see http://www.lyx.org/
\lyxformat 474
\begin_document
\begin_header
\textclass article
\begin_preamble
% cleveref allows \ref{thm:asdf} instead of Theorem~\ref{thm:asdf}
\usepackage[nameinlink,capitalise,noabbrev]{cleveref}
\AtBeginDocument{\renewcommand{\ref}[1]{\cref{#1}}}

% LyX won't let me include cleveref before theorem declarations so I need to redefine everything as a hack
\theoremstyle{plain}
\newtheorem{mythm}{\protect\theoremname}
\renewenvironment{thm}{\begin{mythm}}{\end{mythm}}
\crefname{mythm}{Theorem}{Theorems}
\theoremstyle{definition}
\newtheorem{mydefn}[mythm]{\protect\definitionname}
\renewenvironment{defn}{\begin{mydefn}}{\end{mydefn}}
\theoremstyle{definition}
\newtheorem{myexample}[mythm]{\protect\examplename}
\renewenvironment{example}{\begin{myexample}}{\end{myexample}}
\theoremstyle{plain}
\newtheorem{myprop}[mythm]{\protect\propositionname}
\renewenvironment{prop}{\begin{myprop}}{\end{myprop}}
\theoremstyle{plain}
\newtheorem{mycor}[mythm]{\protect\corollaryname}
\renewenvironment{cor}{\begin{mycor}}{\end{mycor}}
\theoremstyle{plain}
\newtheorem{mylem}[mythm]{\protect\lemmaname}
\renewenvironment{lem}{\begin{mylem}}{\end{mylem}}
\crefname{mylem}{Lemma}{Lemmas}
\theoremstyle{plain}
\newtheorem{myconjecture}[mythm]{\protect\conjecturename}
\renewenvironment{conjecture}{\begin{myconjecture}}{\end{myconjecture}}
\theoremstyle{remark}
\newtheorem{myrem}[mythm]{\protect\remarkname}
\renewenvironment{rem}{\begin{myrem}}{\end{myrem}}
\theoremstyle{remark}
\newtheorem{myclaim}[mythm]{\protect\claimname}
\renewenvironment{claim}{\begin{myclaim}}{\end{myclaim}}

% equation cref format
\crefformat{equation}{#2(#1)#3}

% \left(\right) should behave the same as ()
\let\originalleft\left
\let\originalright\right
\renewcommand{\left}{\mathopen{}\mathclose\bgroup\originalleft}
\renewcommand{\right}{\aftergroup\egroup\originalright}
\usepackage{pgfplots}
\usetikzlibrary{pgfplots.groupplots}
\usepackage{verbatim}

%make sure tildes in url are vertically centered
\makeatletter
\renewcommand*{\UrlTildeSpecial}{%
  \do\~{%
    \mbox{%
      \fontfamily{ptm}\selectfont
      \textasciitilde
    }%
  }%  
}%    
\let\Url@force@Tilde\UrlTildeSpecial
\makeatother

%graph drawing
\usepackage{tikz}
\usetikzlibrary{external}
\usetikzlibrary{decorations.markings}
\usetikzlibrary{arrows.meta}
\tikzexternalize
\tikzstyle{vertex}=[circle,draw=black,fill=black,inner sep=0,minimum size=0.2cm,text=white,font=\footnotesize]
\tikzset{arc/.style={
        decoration={markings,
            mark= at position 0.5 with {\arrow{Latex[length=2mm,width=2mm]}} ,
        },
        postaction={decorate}
    }
}
\tikzset{every loop/.style={min distance=50,in=50,out=130,looseness=7}}

%caption labels
\usepackage[labelfont=bf,labelsep=period]{caption}

\usepackage{enumitem}
\end_preamble
\use_default_options true
\begin_modules
theorems-ams
\end_modules
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman cmr
\font_sans cmss
\font_typewriter cmtt
\font_math auto
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize 11
\spacing other 0.98
\use_hyperref true
\pdf_bookmarks true
\pdf_bookmarksnumbered false
\pdf_bookmarksopen false
\pdf_bookmarksopenlevel 1
\pdf_breaklinks false
\pdf_pdfborder true
\pdf_colorlinks false
\pdf_backref false
\pdf_pdfusetitle true
\papersize default
\use_geometry true
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\branch Folded
\selected 1
\filename_suffix 0
\color #faf0e6
\end_branch
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 2.5cm
\topmargin 2.5cm
\rightmargin 2.5cm
\bottommargin 2.5cm
\secnumdepth 3
\tocdepth 3
\paragraph_separation skip
\defskip bigskip
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
Hamiltonicity in randomly perturbed digraphs and hypergraphs
\end_layout

\begin_layout Author
Michael Krivelevich, Matthew Kwan, Benny Sudakov
\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\RR}{\mathbb{R}}
{\boldsymbol{\mathbb{R}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\QQ}{\mathbb{Q}}
{\boldsymbol{\mathbb{Q}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\HH}{\mathbb{H}}
{\boldsymbol{\mathbb{H}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\E}{\mathbb{E}}
{\boldsymbol{\mathbb{E}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\Var}{\operatorname{Var}}
{\mathbf{Var}\,}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\CC}{\mathbb{C}}
{\boldsymbol{\mathbb{C}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\NN}{\mathbb{N}}
{\boldsymbol{\mathbb{N}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\ZZ}{\mathbb{Z}}
{\boldsymbol{\mathbb{Z}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\GG}{\mathbb{G}}
{\boldsymbol{\mathbb{G}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\BB}{\mathbb{B}}
{\boldsymbol{\mathbb{B}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\DD}{\mathbb{D}}
{\boldsymbol{\mathbb{D}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\cL}{\mathcal{L}}
{\boldsymbol{\mathcal{L}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\supp}{\operatorname{supp}}
{\mathbf{supp}\,}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\one}{\boldsymbol{1}}
{\boldsymbol{\boldsymbol{1}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\range}[1]{\left[#1\right]}
{\boldsymbol{\left[#1\right]}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\d}{\operatorname{d}}
{\mathbf{d}\,}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\falling}[2]{\left(#1\right)_{#2}}
{\boldsymbol{\left(#1\right)_{#2}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\f}{\mathbf{f}}
{\boldsymbol{\mathbf{f}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\im}{\operatorname{im}}
{\mathbf{im}\,}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\sp}{\operatorname{span}}
{\mathbf{span}\,}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\sign}{\operatorname{sign}}
{\mathbf{sign}\,}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\mod}{\operatorname{mod}}
{\mathbf{mod}\,}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\id}{\operatorname{id}}
{\mathbf{id}\,}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\disc}{\operatorname{disc}}
{\mathbf{disc}\,}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\lindisc}{\operatorname{lindisc}}
{\mathbf{lindisc}\,}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\tr}{\operatorname{tr}}
{\mathbf{tr}\,}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\adj}{\operatorname{adj}}
{\mathbf{adj}\,}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\Unif}{\operatorname{Unif}}
{\mathbf{Unif}\,}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\Po}{\operatorname{Po}}
{\mathbf{Po}\,}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\Bin}{\operatorname{Bin}}
{\mathbf{Bin}\,}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\Ber}{\operatorname{Ber}}
{\mathbf{Ber}\,}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\Geom}{\operatorname{Geom}}
{\mathbf{Geom}\,}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\Hom}{\operatorname{Hom}}
{\mathbf{Hom}\,}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\floor}[1]{\left\lfloor #1\right\rfloor }
{\boldsymbol{\left\lfloor #1\right\rfloor }}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\ceil}[1]{\left\lceil #1\right\rceil }
{\boldsymbol{\left\lceil #1\right\rceil }}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\T}{\mathbf{T}}
{\boldsymbol{\mathbf{T}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\N}{\mathbf{N}}
{\boldsymbol{\mathbf{N}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\B}{\mathbf{B}}
{\boldsymbol{\mathbf{B}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\a}{\boldsymbol{\alpha}}
{\boldsymbol{\boldsymbol{\alpha}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\b}{\boldsymbol{\beta}}
{\boldsymbol{\boldsymbol{\beta}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\x}{\mathbf{x}}
{\boldsymbol{\mathbf{x}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\y}{\mathbf{y}}
{\boldsymbol{\mathbf{y}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\o}{\boldsymbol{\omega}}
{\boldsymbol{\boldsymbol{\omega}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\cdi}{c}
{\boldsymbol{c}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\chypham}{c_{k}^{\mathrm{H}}}
{\boldsymbol{c_{k}^{\mathrm{H}}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\chypmat}{c_{k}^{\mathrm{M}}}
{\boldsymbol{c_{k}^{\mathrm{M}}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\cto}{c^{\mathrm{T}}}
{\boldsymbol{c^{\mathrm{T}}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\amat}{\beta^{\mathrm{M}}}
{\boldsymbol{\beta^{\mathrm{M}}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\aham}{\beta^{\mathrm{H}}}
{\boldsymbol{\beta^{\mathrm{H}}}}
\end_inset


\end_layout

\begin_layout Abstract
We give several results showing that different discrete structures become
 Hamiltonian after a modest random perturbation.
 First, we show that adding linearly many random edges to a dense hypergraph
 ensures the (asymptotically almost sure) existence of a matching or a loose
 Hamilton cycle.
 This involves a nonstandard application of Szemer
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
'
\end_layout

\end_inset

edi's Regularity Lemma.
 We next show that digraphs with certain strong expansion properties are
 pancyclic, and use this to show that adding a linear number of random edges
 makes a dense digraph pancyclic.
 Finally, we show that perturbing a certain (minimum-degree-dependent) number
 of random edges in a tournament ensures the existence of multiple edge-disjoint
 Hamilton cycles.
 All our results are tight.
\end_layout

\begin_layout Standard
\begin_inset Branch Folded
status open

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{comment}
\end_layout

\end_inset


\end_layout

\begin_layout Theorem
t
\end_layout

\begin_layout Corollary
c
\end_layout

\begin_layout Lemma
l
\end_layout

\begin_layout Proposition
p
\end_layout

\begin_layout Conjecture
c
\end_layout

\begin_layout Definition
d
\end_layout

\begin_layout Example
e
\end_layout

\begin_layout Remark
r
\end_layout

\begin_layout Claim
c
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{comment}
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
We say that a graph is 
\emph on
Hamiltonian
\emph default
 if it has a 
\emph on
Hamilton cycle
\emph default
: a simple cycle containing every vertex in the graph.
 Hamiltonicity is a central notion in graph theory and has been extensively
 studied in a wide range of contexts.
 In particular, due to a seminal paper by Karp 
\begin_inset CommandInset citation
LatexCommand cite
key "Kar72"

\end_inset

, it has become a canonical NP-complete problem to determine whether an
 arbitrary graph is Hamiltonian.
 There are nevertheless a variety of easily-checkable conditions that guarantee
 Hamiltonicity.
 The most famous of these is given by a classical theorem of Dirac 
\begin_inset CommandInset citation
LatexCommand cite
key "Dir52"

\end_inset

, which states that any 
\begin_inset Formula $n$
\end_inset

-vertex graph with minimum degree at least 
\begin_inset Formula $n/2$
\end_inset

 is Hamiltonian.
\end_layout

\begin_layout Standard
Dirac's theorem requires a very strong density condition, but in a certain
 asymptotic sense 
\begin_inset Quotes eld
\end_inset

almost all
\begin_inset Quotes erd
\end_inset

 dense graphs are Hamiltonian.
 If we fix 
\begin_inset Formula $\alpha>0$
\end_inset

 and select a graph uniformly at random among the (labelled) graphs with
 
\begin_inset Formula $n$
\end_inset

 vertices and 
\begin_inset Formula $\alpha{n \choose 2}$
\end_inset

 edges, then the degrees will probably each be about 
\begin_inset Formula $\alpha n$
\end_inset

.
 Such a random graph is Hamiltonian with probability 
\begin_inset Formula $1-o\left(1\right)$
\end_inset

 (we say it is Hamiltonian 
\emph on
asymptotically almost surely
\emph default
, or 
\emph on
a.a.s.
\emph default
).
 This follows from a stronger result 
\begin_inset CommandInset citation
LatexCommand cite
key "Pos76"

\end_inset

 that gives a 
\emph on
threshold
\emph default
 for Hamiltonicity: a random 
\begin_inset Formula $n$
\end_inset

-vertex, 
\begin_inset Formula $m$
\end_inset

-edge graph is Hamiltonian a.a.s.
 if 
\begin_inset Formula $m\gg n\log n$
\end_inset

, and fails to be Hamiltonian a.a.s.
 if 
\begin_inset Formula $m\ll n\log n$
\end_inset

.
 Here and from now on, all asymptotics are as 
\begin_inset Formula $n\to\infty$
\end_inset

, and we implicitly round large quantities to integers.
\end_layout

\begin_layout Standard
In 
\begin_inset CommandInset citation
LatexCommand cite
key "BFM03"

\end_inset

, the authors studied the random graph model that starts with a dense graph
 and adds 
\begin_inset Formula $m$
\end_inset

 random edges (this model has since been studied in a number of other contexts;
 see for example 
\begin_inset CommandInset citation
LatexCommand cite
key "BHM04,KST06"

\end_inset

).
 They found that to ensure Hamiltonicity in this model we only need 
\begin_inset Formula $m$
\end_inset

 to be linear, saving a logarithmic factor over the standard model where
 we start with nothing.
 To be precise, 
\begin_inset CommandInset citation
LatexCommand cite
after "Theorem~1"
key "BFM03"

\end_inset

 says that for every 
\begin_inset Formula $\alpha>0$
\end_inset

 there is 
\begin_inset Formula $\cdi\left(\alpha\right)$
\end_inset

 such that if we start with a graph with minimum degree at least 
\begin_inset Formula $\alpha n$
\end_inset

 and add 
\begin_inset Formula $\cdi\left(\alpha\right)n$
\end_inset

 random edges, then the resulting graph will a.a.s.
 be Hamiltonian.
 Note that some dense graphs require a linear number of extra edges to become
 Hamiltonian (consider the complete bipartite graph with partition sizes
 
\begin_inset Formula $n/3$
\end_inset

 and 
\begin_inset Formula $2n/3$
\end_inset

), so this result is asymptotically tight.
 We can interpret this theorem as quantifying the 
\begin_inset Quotes eld
\end_inset

fragility
\begin_inset Quotes erd
\end_inset

 of the few dense graphs that are not Hamiltonian, by determining the amount
 of random perturbation that is necessary to make a dense graph Hamiltonian.
 A comparison can be drawn to the notion of 
\emph on
smoothed analysis
\emph default
 of algorithms introduced in 
\begin_inset CommandInset citation
LatexCommand cite
key "ST04"

\end_inset

, which involves studying the performance of algorithms on randomly perturbed
 inputs.
\end_layout

\begin_layout Standard
Our first contribution in this paper is to generalize the aforementioned
 theorem to hypergraphs (and to give a corresponding result for perfect
 matchings, which is nontrivial in the hypergraph setting).
 Unfortunately, there is no single most natural notion of a cycle or of
 minimum degree in hypergraphs.
 A 
\begin_inset Formula $k$
\end_inset

-uniform 
\emph on
loose
\emph default
 cycle is a 
\begin_inset Formula $k$
\end_inset

-uniform hypergraph with a cyclic ordering on its vertices such that every
 edge consists of 
\begin_inset Formula $k$
\end_inset

 consecutive vertices and every pair of consecutive edges intersects in
 exactly one vertex.
 The degree of a set of vertices is the number of edges that include that
 set, and the 
\emph on
minimum 
\begin_inset Formula $\left(k-1\right)$
\end_inset

-degree 
\emph default

\begin_inset Formula $\delta_{k-1}$
\end_inset

 is the minimum degree among sets of 
\begin_inset Formula $k-1$
\end_inset

 vertices.
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:hypergraph-theorems"

\end_inset

Let 
\begin_inset Formula $\HH_{k}\left(n,m\right)$
\end_inset

 be the uniform distribution on 
\begin_inset Formula $m$
\end_inset

-edge 
\begin_inset Formula $k$
\end_inset

-uniform hypergraphs on the vertex set 
\begin_inset Formula $\range n$
\end_inset

.
\end_layout

\begin_layout Theorem
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{enumerate}[topsep=0px,label=(
\backslash
alph*)]
\end_layout

\end_inset


\end_layout

\begin_layout Theorem
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
item{
\end_layout

\end_inset

There is 
\begin_inset Formula $\chypmat\left(\alpha\right)$
\end_inset

 such that if 
\begin_inset Formula $H$
\end_inset

 is a 
\begin_inset Formula $k$
\end_inset

-uniform hypergraph on 
\begin_inset Formula $\left[kn\right]$
\end_inset

 with 
\begin_inset Formula $\delta_{k-1}\left(H\right)\ge\alpha n$
\end_inset

, and 
\begin_inset Formula $R\in\HH_{k}\left(kn,\chypmat\left(\alpha\right)n\right)$
\end_inset

, then 
\begin_inset Formula $H\cup R$
\end_inset

 a.a.s.
 has a perfect matching.
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Theorem
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
item{
\end_layout

\end_inset

There is 
\begin_inset Formula $\chypham\left(\alpha\right)$
\end_inset

 such that if 
\begin_inset Formula $H$
\end_inset

 is a 
\begin_inset Formula $k$
\end_inset

-uniform hypergraph on 
\begin_inset Formula $\left[\left(k-1\right)n\right]$
\end_inset

with 
\begin_inset Formula $\delta_{k-1}\left(H\right)\ge\alpha n$
\end_inset

, and 
\begin_inset Formula $R\in\HH\left(\left(k-1\right)n,\chypham\left(\alpha\right)n\right)$
\end_inset

, then 
\begin_inset Formula $H\cup R$
\end_inset

 a.a.s.
 has a loose Hamilton cycle.
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Theorem
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{enumerate}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
There is a corresponding Dirac-type theorem for loose Hamilton cycles in
 dense hypergraphs (see 
\begin_inset CommandInset citation
LatexCommand cite
key "KKMO11"

\end_inset

), and the threshold for both perfect matchings and loose Hamilton cycles
 is 
\begin_inset Formula $n^{k-1}\log n$
\end_inset

 random edges (see 
\begin_inset CommandInset citation
LatexCommand cite
key "DF11"

\end_inset

 and 
\begin_inset CommandInset citation
LatexCommand cite
after "Corollary~2.6"
key "JKV08"

\end_inset

), so 
\begin_inset Quotes eld
\end_inset

almost all
\begin_inset Quotes erd
\end_inset

 dense hypergraphs have Hamilton cycles and perfect matchings.
 However, for hypergraphs with large uniformity our conclusion is much more
 extreme than for graphs: starting from a dense hypergraph only 
\begin_inset Formula $O\left(n\right)$
\end_inset

 extra edges are requred to ensure Hamiltonicity, which is far fewer than
 the 
\begin_inset Formula $\Omega\left(n^{k-1}\log n\right)$
\end_inset

 edges required to reach Hamiltonicity from scratch.
\end_layout

\begin_layout Standard
We will prove 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:hypergraph-theorems"

\end_inset

, and show that it is tight, in 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:hypergraphs"

\end_inset

.
 The methods usually employed to study Hamilton cycles and perfect matchings
 in random graphs are largely ineffective in the hypergraph setting, so
 we need a very different proof.
 In particular, we cannot easily manipulate paths for P
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
'
\end_layout

\end_inset

osa-type arguments, and we do not have an analogue of Hall's marriage theorem
 allowing us to deduce the existence of a perfect matching from an expansion
 property.
 Our proof involves reducing the theorem to the existence of a perfect matching
 in a certain randomly perturbed bipartite graph.
 The 
\begin_inset Quotes eld
\end_inset

reason
\begin_inset Quotes erd
\end_inset

 for a perfect matching in this perturbed graph seems to be quite different
 depending on the structure of the initial bipartite graph, so we make critical
 use of the structural description given by Szemer
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
'
\end_layout

\end_inset

edi's regularity lemma.
\end_layout

\begin_layout Standard
Our second contribution in this paper is a theorem giving a general expansion
 condition for
\emph on
 pancyclicity
\emph default
.
 We say an 
\begin_inset Formula $n$
\end_inset

-vertex 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
mbox{
\end_layout

\end_inset

(di-)
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset

graph is pancyclic if it contains cycles of all lengths ranging from 3 to
 
\begin_inset Formula $n$
\end_inset

.
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "lem:pseudorandom-pancyclic"

\end_inset

Let 
\begin_inset Formula $D$
\end_inset

 be a directed graph on 
\begin_inset Formula $n$
\end_inset

 vertices with all in- and out- degrees at least 
\begin_inset Formula $8k$
\end_inset

, and suppose for all disjoint 
\begin_inset Formula $A,B\subseteq V\left(D\right)$
\end_inset

 with 
\begin_inset Formula $\left|A\right|=\left|B\right|\ge k$
\end_inset

, there is an arc from 
\begin_inset Formula $A$
\end_inset

 to 
\begin_inset Formula $B$
\end_inset

.
 Then 
\begin_inset Formula $D$
\end_inset

 is pancyclic.
\end_layout

\begin_layout Standard
We hope this theorem could be of general interest, but our particular motivation
 is that it implies a number of results about randomly perturbed graphs
 and digraphs.
 In particular it provides very simple proofs of the theorems in 
\begin_inset CommandInset citation
LatexCommand cite
key "BFM03"

\end_inset

 concerning Hamiltonicity in randomly perturbed graphs and digraphs, and
 allows us to extend these theorems to pancyclicity.
 We will prove 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:pseudorandom-pancyclic"

\end_inset

 and its corollaries in 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:digraphs"

\end_inset

.
\end_layout

\begin_layout Standard
Our final theorem concerns randomly perturbed tournaments.
 The model that starts with a fixed 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
mbox{
\end_layout

\end_inset

(di-/hyper-)
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset

graph and adds random edges is not suitable for studying random perturbation
 in tournaments, because we want our perturbed tournament to remain a tournament.
 There are several other models of random perturbation we could consider
 that do allow us to make sense of randomly perturbed tournaments, or are
 more natural in certain contexts.
 However, the types of results in this paper are not sensitive to the model
 used.
 We will briefly describe a few different models here.
\end_layout

\begin_layout Standard
First, note that for most practical purposes, models that involve the selection
 of 
\begin_inset Formula $m$
\end_inset

 random edges are equivalent to models that involve the selection of each
 edge with independent probability 
\begin_inset Formula $p$
\end_inset

, where 
\begin_inset Formula $m=p{n \choose 2}$
\end_inset

.
 One perspective or the other can be more intuitive or result in cleaner
 proofs; we will use both interchangeably as is convenient without further
 discussion.
 In all the situations in this paper, equivalence can be proved with standard
 conditioning and coupling arguments.
\end_layout

\begin_layout Standard
As suggested in 
\begin_inset CommandInset citation
LatexCommand cite
after "Definition~1"
key "ST03"

\end_inset

, one possible alternative model is to 
\emph on
change
\emph default
 random edges, instead of adding them.
 So, for our results so far, instead of taking the union of a fixed dense
 object with a random sparse object, we would take the symmetric difference.
 Our results still hold in this alternative model, basically because we
 can break up such a random perturbation into a phase that deletes edges
 (this does not destroy denseness), and a phase that adds edges.
 One undesirable quirk of this model is that it is not 
\begin_inset Quotes eld
\end_inset

monotonic
\begin_inset Quotes erd
\end_inset

: if we change too many edges then we 
\begin_inset Quotes eld
\end_inset

lose our randomness
\begin_inset Quotes erd
\end_inset

 and end up at the complement of our original object, which might not be
 Hamiltonian.
\end_layout

\begin_layout Standard
A second alternative model is to start with our fixed object and 
\begin_inset Quotes eld
\end_inset

make it more random
\begin_inset Quotes erd
\end_inset

 by interpolating slightly towards the corresponding uniform distribution.
 For example, in the graph case we could randomly designate a small number
 of pairs of vertices for 
\begin_inset Quotes eld
\end_inset

resampling
\begin_inset Quotes erd
\end_inset

 and then decide whether the corresponding edges should be present uniformly
 and independently at random.
 This is mostly equivalent to the symmetric difference model, and is the
 model in which we prefer to state our theorem about randomly perturbed
 tournaments.
\end_layout

\begin_layout Standard
It is known that almost all tournaments have a Hamiltonian cycle (see 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:tournaments"

\end_inset

), so we do not need to restrict our attention to 
\begin_inset Quotes eld
\end_inset

dense
\begin_inset Quotes erd
\end_inset

 tournaments.
 Nevertheless, we can give stronger results for tournaments with large minimum
 in- and out- degrees.
 We are also able to show that randomly perturbed tournaments are not just
 Hamiltonian, but have multiple edge-disjoint Hamilton cycles.
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:tournament"

\end_inset

Consider a tournament 
\begin_inset Formula $T$
\end_inset

 with 
\begin_inset Formula $n$
\end_inset

 vertices and all in- and out- degrees at least 
\begin_inset Formula $d$
\end_inset

.
 Independently designate 
\begin_inset Formula $m=\omega\left(d+1\right)/n$
\end_inset

 edges as 
\begin_inset Quotes eld
\end_inset

random
\begin_inset Quotes erd
\end_inset

 then choose the orientations of the chosen edges independently and uniformly
 at random.
 The resulting perturbed tournament 
\begin_inset Formula $P$
\end_inset

 a.a.s.
 has 
\begin_inset Formula $q$
\end_inset

 arc-disjoint Hamilton cycles, for 
\begin_inset Formula $q=O\left(1\right)$
\end_inset

.
\end_layout

\begin_layout Standard
We will prove 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:tournament"

\end_inset

 and show that it is tight in 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:tournaments"

\end_inset

.
\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sec:hypergraphs"

\end_inset

Perfect Matchings and Hamilton Cycles in Hypergraphs
\end_layout

\begin_layout Standard
We first make some observations about our minimum degree requirement.
 The 
\emph on
minimum 
\begin_inset Formula $q$
\end_inset

-degree
\emph default
 
\begin_inset Formula $\delta_{q}\left(H\right)$
\end_inset

 of 
\begin_inset Formula $H$
\end_inset

 is the minimum degree among all sets of 
\begin_inset Formula $q$
\end_inset

 vertices.
 Note that this generalizes the two notions of denseness for graphs: in
 some contexts, we say graphs are dense if they have many edges (large 
\begin_inset Formula $\delta_{0}$
\end_inset

), whereas in this paper we need a stronger notion of graph denseness based
 on minimum degree (
\begin_inset Formula $\delta_{1}$
\end_inset

).
 For a 
\begin_inset Formula $k$
\end_inset

-regular hypergraph 
\begin_inset Formula $H$
\end_inset

, a double-counting argument shows that if 
\begin_inset Formula $q\le p$
\end_inset

 then 
\begin_inset Formula 
\[
\delta_{q}\left(H\right)\ge\delta_{p}\left(H\right){n-q \choose p-q}\left.\vphantom{\sum}\right/{k-q \choose p-q}.
\]

\end_inset

So, imposing that a 
\begin_inset Formula $k$
\end_inset

-uniform hypergraph has large 
\begin_inset Formula $\left(k-1\right)$
\end_inset

-degree ensures that it has large 
\begin_inset Formula $q$
\end_inset

-degrees for all 
\begin_inset Formula $q$
\end_inset

.
 In particular, our requirement 
\begin_inset Formula $\delta_{k-1}\left(H\right)=\Omega\left(n\right)$
\end_inset

 actually implies 
\begin_inset Formula $\delta_{q}\left(H\right)=\Omega\left(n^{k-q}\right)$
\end_inset

 for all 
\begin_inset Formula $q$
\end_inset

.
\end_layout

\begin_layout Standard
Next, note that 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:hypergraph-theorems"

\end_inset

 is tight for essentially the same reason as 
\begin_inset CommandInset citation
LatexCommand cite
after "Theorem~1"
key "BFM03"

\end_inset

: consider the 
\begin_inset Quotes eld
\end_inset

complete bipartite hypergraph
\begin_inset Quotes erd
\end_inset

 which has two partitions of sizes 
\begin_inset Formula $n$
\end_inset

 and 
\begin_inset Formula $2kn$
\end_inset

, and has all possible 
\begin_inset Formula $k$
\end_inset

-edges that contain at least one vertex from each partition.
 Only 
\begin_inset Formula $2n$
\end_inset

 of these edges can contribute to a loose Hamilton cycle, so a linear number
 must be added to complete the necessary 
\begin_inset Formula $\left(2k+1\right)n/\left(k-1\right)$
\end_inset

 edges.
\end_layout

\begin_layout Standard
Now we proceed to the proof of 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:hypergraph-theorems"

\end_inset

, which will follow from a sequence of lemmas.
 The first step is to show that 
\begin_inset Formula $R$
\end_inset

 almost gives the structure of interest on its own.
 Let a
\emph on
 sub-cycle
\emph default
 be a hypergraph which can be extended to a loose Hamilton cycle by adding
 edges.
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:hypergraph-almost-object"

\end_inset

For any 
\begin_inset Formula $\varepsilon>0$
\end_inset

:
\end_layout

\begin_layout Lemma
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{enumerate}[topsep=0px,label=(
\backslash
alph*)]
\end_layout

\end_inset


\end_layout

\begin_layout Lemma
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
item{
\end_layout

\end_inset

There is 
\begin_inset Formula $b_{k}^{\mathrm{M}}\left(\varepsilon\right)$
\end_inset

 such that 
\begin_inset Formula $R\in\HH_{k}\left(kn,b_{k}^{\mathrm{M}}\left(\varepsilon\right)\right)$
\end_inset

 a.a.s.
 has a matching of size 
\begin_inset Formula $\left(1-\varepsilon\right)n$
\end_inset

.
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Lemma
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
item{
\end_layout

\end_inset

For any 
\begin_inset Formula $\varepsilon>0$
\end_inset

, there is 
\begin_inset Formula $b_{k}^{\mathrm{H}}\left(\varepsilon\right)$
\end_inset

 such that 
\begin_inset Formula $R\in\HH_{k}\left(\left(k-1\right)n,b_{k}^{\mathrm{H}}\left(\varepsilon\right)\right)$
\end_inset

 a.a.s.
 has a sub-cycle of size 
\begin_inset Formula $\left(1-\varepsilon\right)n$
\end_inset

.
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Lemma
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{enumerate}
\end_layout

\end_inset


\end_layout

\begin_layout Proof
\begin_inset ERT
status open

\begin_layout Plain Layout

[Proof of 
\backslash
ref{lem:hypergraph-almost-object}(a)]
\end_layout

\end_inset

To realize the distribution 
\begin_inset Formula $\HH_{k}\left(kn,\beta_{k}'\left(\varepsilon\right)n\right)$
\end_inset

, imagine that independently uniformly random edges are repeatedly dropping
 into 
\begin_inset Formula $R$
\end_inset

, until we have seen 
\begin_inset Formula $b_{k}^{\mathrm{M}}\left(\varepsilon\right)$
\end_inset

 distinct edges.
 We iteratively build a matching 
\begin_inset Formula $M$
\end_inset

 greedily.
 If a new edge 
\begin_inset Formula $e$
\end_inset

 drops into 
\begin_inset Formula $R$
\end_inset

 which does not share any vertices with the edges in 
\begin_inset Formula $M$
\end_inset

 so far, then add 
\begin_inset Formula $e$
\end_inset

 to 
\begin_inset Formula $M$
\end_inset

.
 If we have already added 
\begin_inset Formula $i$
\end_inset

 edges to 
\begin_inset Formula $M$
\end_inset

, then the probability we will add the next random edge is
\begin_inset Formula 
\[
p_{i}={kn-ki \choose k}\left.\vphantom{\sum}\right/{kn \choose k}=\Omega\left(\left(\frac{n-i}{n}\right)^{k}\right).
\]

\end_inset

The number of random edges required to build a matching of size 
\begin_inset Formula $\left(1-\varepsilon\right)n$
\end_inset

 therefore has the distribution of
\begin_inset Formula 
\[
X=\sum_{i=1}^{\left(1-\varepsilon\right)n}X_{i},
\]

\end_inset

where each 
\begin_inset Formula $X_{i}$
\end_inset

 is independently geometrically distributed with success probability 
\begin_inset Formula $p_{i}$
\end_inset

.
 By Chebyshev's inequality or a Chernoff bound, 
\begin_inset Formula $X$
\end_inset

 is a.a.s.
 close to its expectation, which is at most 
\begin_inset Formula 
\[
O\left(\sum_{i=1}^{\left(1-\varepsilon\right)n}n^{k}/\left(n-i\right)^{k}\right)=O\left(n^{k}\int_{\varepsilon n}^{\infty}\frac{1}{x^{k}}dx\right)=O\left(n\right).
\]

\end_inset

So, if 
\begin_inset Formula $b_{k}^{\mathrm{M}}\left(\varepsilon\right)$
\end_inset

 is large enough then a.a.s.
 
\begin_inset Formula $\left|M\right|\ge\left(1-\varepsilon\right)n$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Proof
\begin_inset ERT
status open

\begin_layout Plain Layout

[Proof of 
\backslash
ref{lem:hypergraph-almost-object}(b)]
\end_layout

\end_inset

A sub-cycle is a loose Hamilton cycle or a disjoint union of 
\begin_inset Quotes eld
\end_inset

loose paths
\begin_inset Quotes erd
\end_inset

, but a union of disjoint paths may not be a sub-cycle if it has so many
 paths that there are not enough vertices left to link them together.
 A union of 
\begin_inset Formula $j$
\end_inset

 paths (which have length greater than zero) with a total of 
\begin_inset Formula $i$
\end_inset

 edges is a sub-cycle precisely when 
\begin_inset Formula $i+j\le n$
\end_inset

.
 Call such sub-cycles 
\emph on
proper 
\emph default
sub-cycles.
\end_layout

\begin_layout Proof
As in the proof of 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:hypergraph-almost-object"

\end_inset

, imagine that independently uniformly random edges are repeatedly dropping
 into 
\begin_inset Formula $R$
\end_inset

.
 We build a proper sub-cycle 
\begin_inset Formula $S$
\end_inset

 greedily.
 Suppose we are at a point where 
\begin_inset Formula $S$
\end_inset

 has 
\begin_inset Formula $i$
\end_inset

 edges and 
\begin_inset Formula $j$
\end_inset

 paths, with 
\begin_inset Formula $i\le\left(1-\varepsilon\right)n$
\end_inset

.
 There are 
\begin_inset Formula $\left(k-1\right)i+j\le\left(k-2\right)i+n$
\end_inset

 vertices in the paths in 
\begin_inset Formula $S$
\end_inset

.
 
\end_layout

\begin_layout Proof
There are 3 kinds of edges we can add to 
\begin_inset Formula $S$
\end_inset

: an edge that starts a new loose path (
\begin_inset Quotes eld
\end_inset

type 1
\begin_inset Quotes erd
\end_inset

), an edge that extends an existing path (
\begin_inset Quotes eld
\end_inset

type 2
\begin_inset Quotes erd
\end_inset

), or an edge that joins two paths together (
\begin_inset Quotes eld
\end_inset

type 3
\begin_inset Quotes erd
\end_inset

).
 We can only add a type 1 edge when 
\begin_inset Formula $i+j\le n-2$
\end_inset

, and can only add a type 2 edge when 
\begin_inset Formula $i+j\le n-1$
\end_inset

.
\end_layout

\begin_layout Proof
If 
\begin_inset Formula $i+j\le n-2$
\end_inset

 then there are at least 
\begin_inset Formula 
\[
{\left(k-1\right)n-\left(\left(k-2\right)i+n\right) \choose k}={\left(k-2\right)\left(n-i\right) \choose k}=\Omega\left(\left(n-i\right)^{k}\right)
\]

\end_inset

type-1 edges that could possibly be added.
 Otherwise, we must have 
\begin_inset Formula $j>n-2-i\ge\varepsilon n-2$
\end_inset

, so (identifying one vertex in an extremal edge of each path as 
\begin_inset Quotes eld
\end_inset

eligible to be joined
\begin_inset Quotes erd
\end_inset

), there are at least 
\begin_inset Formula 
\[
{j \choose 2}{\left(k-2\right)\left(n-i\right) \choose k-2}=\Omega\left(n^{2}\left(n-i\right)^{k-2}\right)=\Omega\left(\left(n-i\right)^{k}\right)
\]

\end_inset

type-3 edges that could be added.
 Combining both cases, we can see that if 
\begin_inset Formula $S$
\end_inset

 has 
\begin_inset Formula $i\le\left(1-\varepsilon\right)n$
\end_inset

 edges, then the next edge will be added with probability at least
\begin_inset Formula 
\[
\Omega\left(\left(n-i\right)^{k}\right)\left.\vphantom{\sum}\right/{\left(k-1\right)n \choose k}=\Omega\left(\left(\frac{n-i}{n}\right)^{k}\right).
\]

\end_inset

We conclude with the same reasoning as the proof of 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:hypergraph-almost-object"

\end_inset

(a).
\end_layout

\begin_layout Standard
The second step to prove 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:tournament"

\end_inset

 is to show that a dense hypergraph plus a large partial structure a.a.s.
 gives the structure we are looking for.
 For both theorems, we will be able to reduce this step to the following
 lemma.
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:bipartite-plus-big-matching-perfect"

\end_inset

There is 
\begin_inset Formula $\xi\left(\alpha\right)>0$
\end_inset

 such that the following holds.
 Let 
\begin_inset Formula $G$
\end_inset

 be a bipartite graph with partitions 
\begin_inset Formula $A,B$
\end_inset

 of equal size 
\begin_inset Formula $n$
\end_inset

, and suppose 
\begin_inset Formula $\delta\left(G\right)\ge\alpha n$
\end_inset

.
 Let 
\begin_inset Formula $M$
\end_inset

 be a uniformly random matching with 
\begin_inset Formula $\left(1-\xi\left(\alpha\right)\right)n$
\end_inset

 edges between 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

.
 Then 
\begin_inset Formula $G\cup M$
\end_inset

 has a perfect matching.
\end_layout

\begin_layout Standard
The immediate na
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
"
\end_layout

\end_inset

ive approach to prove this lemma would be to apply Hall's marriage theorem,
 by showing that each set of vertices expands with high probability and
 then applying a union bound.
 However, the probability of failure to expand is not small enough for this
 to work.
 We can gain some insight into the problem by considering two 
\begin_inset Quotes eld
\end_inset

extremal
\begin_inset Quotes erd
\end_inset

 cases for 
\begin_inset Formula $G$
\end_inset

.
 First, consider the case where the edges of 
\begin_inset Formula $G$
\end_inset

 are not evenly-distributed, and are 
\begin_inset Quotes eld
\end_inset

concentrated
\begin_inset Quotes erd
\end_inset

 in certain spots.
 For example, identify sets 
\begin_inset Formula $A'\subset A$
\end_inset

 and 
\begin_inset Formula $B'\subset B$
\end_inset

 with 
\begin_inset Formula $\left|A'\right|,\left|B'\right|=\alpha n$
\end_inset

, and let 
\begin_inset Formula $G$
\end_inset

 contain only those edges incident to a vertex in 
\begin_inset Formula $A'$
\end_inset

 or 
\begin_inset Formula $B'$
\end_inset

.
 The addition of the near-perfect matching 
\begin_inset Formula $M$
\end_inset

 gives a near-perfect matching between 
\begin_inset Formula $A\backslash A'$
\end_inset

 and 
\begin_inset Formula $B\backslash B'$
\end_inset

, and we can match the unmatched vertices from 
\begin_inset Formula $A$
\end_inset

 (respectively 
\begin_inset Formula $B$
\end_inset

) with any element of 
\begin_inset Formula $B'$
\end_inset

 (respectively 
\begin_inset Formula $A'$
\end_inset

).
 That is, if our graph is not well-distributed, then the more concentrated
 parts help us augment 
\begin_inset Formula $M$
\end_inset

 into a perfect matching in 
\begin_inset Formula $G\cup M$
\end_inset

.
 On the other extreme, if 
\begin_inset Formula $G$
\end_inset

 is a random-like, well-distributed dense graph then we cannot augment 
\begin_inset Formula $M$
\end_inset

 in the same way.
 But this is not necssary, because a random dense graph 
\begin_inset Formula $G$
\end_inset

 contains a perfect matching on its own! In order to apply these ideas to
 prove the lemma for an arbitrary graph 
\begin_inset Formula $G$
\end_inset

, we use the structural description of 
\begin_inset Formula $G$
\end_inset

 provided by Szemer
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
'
\end_layout

\end_inset

edi's regularity lemma.
\end_layout

\begin_layout Standard
We will use a bipartite version of the regularity lemma (which can be deduced
 from say 
\begin_inset CommandInset citation
LatexCommand cite
after "Theorem~2.3"
key "Tao05"

\end_inset

 in a similar way to 
\begin_inset CommandInset citation
LatexCommand cite
after "Theorem~1.10"
key "KS96"

\end_inset

).
 Let 
\begin_inset Formula $\alpha'=\alpha/2$
\end_inset

 and let 
\begin_inset Formula $\varepsilon>0$
\end_inset

 be a small constant depending on 
\begin_inset Formula $\alpha$
\end_inset

 that will be determined later (assume for now that 
\begin_inset Formula $\varepsilon<\alpha/8$
\end_inset

).
 There is a large constant 
\begin_inset Formula $K$
\end_inset

 depending only on 
\begin_inset Formula $\alpha$
\end_inset

 such that there exist partitions 
\begin_inset Formula $A=V_{0}^{1}\cup\dots\cup V_{k}^{1}$
\end_inset

 and 
\begin_inset Formula $B=V_{0}^{2}\cup\dots\cup V_{k}^{2}$
\end_inset

 with 
\begin_inset Formula $k\le K$
\end_inset

, in such a way that the following conditions are satisfied.
 The 
\begin_inset Quotes eld
\end_inset

exceptional
\begin_inset Quotes erd
\end_inset

 clusters 
\begin_inset Formula $V_{0}^{1}$
\end_inset

 and 
\begin_inset Formula $V_{0}^{2}$
\end_inset

 both have fewer than 
\begin_inset Formula $\varepsilon n$
\end_inset

 vertices, and the non-exceptional clusters in 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 have equal size: 
\begin_inset Formula $\left|V_{1}^{1}\right|=\dots=\left|V_{k}^{\ell}\right|=an$
\end_inset

 and 
\begin_inset Formula $\left|V_{1}^{1}\right|=\dots=\left|V_{k}^{\ell}\right|=bn$
\end_inset

.
 There is a subgraph 
\begin_inset Formula $G'\subseteq G$
\end_inset

 with minimum degree at least 
\begin_inset Formula $\left(\alpha'+\varepsilon\right)n$
\end_inset

 such that each pair of distinct clusters 
\begin_inset Formula $V_{i}^{1},V_{j}^{2}$
\end_inset

 (
\begin_inset Formula $i,j\ge1$
\end_inset

) is 
\begin_inset Formula $\varepsilon$
\end_inset

-regular in 
\begin_inset Formula $G'$
\end_inset

 with density zero or at least 
\begin_inset Formula $2\varepsilon$
\end_inset

.
\end_layout

\begin_layout Standard
Define the cluster graph 
\begin_inset Formula $C$
\end_inset

 as the bipartite graph whose vertices are the non-exceptional clusters
 
\begin_inset Formula $V_{i}^{\ell}$
\end_inset

, and whose edges are the pairs of clusters between which there is nonzero
 density in 
\begin_inset Formula $G'$
\end_inset

.
 The fact that 
\begin_inset Formula $G$
\end_inset

 is dense implies that 
\begin_inset Formula $C$
\end_inset

 is dense as well: note that in 
\begin_inset Formula $G'$
\end_inset

 each 
\begin_inset Formula $V_{i}^{\ell}$
\end_inset

 has at least 
\begin_inset Formula $\left(\alpha'+\varepsilon\right)n\left|V_{i}^{\ell}\right|$
\end_inset

 edges to other clusters.
 There are at most 
\begin_inset Formula $\varepsilon n\left|V_{i}^{\ell}\right|$
\end_inset

 edges to the exceptional cluster 
\begin_inset Formula $V_{0}$
\end_inset

 and at most 
\begin_inset Formula $\left|V_{i}^{\ell}\right|^{2}$
\end_inset

 edges to each other cluster.
 So, 
\begin_inset Formula $d_{C}\left(V_{i}^{\ell}\right)\ge\left(\left(\alpha'+\varepsilon\right)n\left|V_{i}^{\ell}\right|-\varepsilon n\left|V_{i}^{\ell}\right|\right)/\left|V_{i}^{\ell}\right|^{2}\ge\alpha'k$
\end_inset

 and 
\begin_inset Formula $C$
\end_inset

 has minimum degree at least 
\begin_inset Formula $\alpha'k$
\end_inset

.
\end_layout

\begin_layout Proof
\begin_inset ERT
status open

\begin_layout Plain Layout

[Proof of 
\backslash
ref{lem:bipartite-plus-big-matching-perfect}]
\end_layout

\end_inset

We use Hall's marriage theorem: we need to show that a.a.s.
 
\begin_inset Formula $\left|N_{G\cup M}\left(W\right)\right|\ge\left|W\right|$
\end_inset

 for all 
\begin_inset Formula $W\subseteq A$
\end_inset

.
 If 
\begin_inset Formula $\left|W\right|\le\alpha n$
\end_inset

, then 
\begin_inset Formula $\left|N_{G\cup M}\left(W\right)\right|\ge\left|N_{G}\left(W\right)\right|\ge\alpha n\ge\left|W\right|$
\end_inset

 by the degree condition on 
\begin_inset Formula $G$
\end_inset

.
 Similarly, if 
\begin_inset Formula $\left|W\right|\ge\left(1-\alpha\right)n$
\end_inset

 then every 
\begin_inset Formula $b\in B$
\end_inset

 has an edge to 
\begin_inset Formula $W$
\end_inset

 in 
\begin_inset Formula $G$
\end_inset

, so 
\begin_inset Formula $\left|N_{G\cup M}\left(W\right)\right|=\left|B\right|\ge\left|W\right|$
\end_inset

.
 The difficult case is where 
\begin_inset Formula $\alpha n\le\left|W\right|\le\left(1-\alpha\right)n$
\end_inset

.
 
\end_layout

\begin_layout Proof
Apply our version of the regularity lemma.
 We first want to prove that the edges of 
\begin_inset Formula $M$
\end_inset

 a.a.s.
 
\begin_inset Quotes eld
\end_inset

spread out evenly
\begin_inset Quotes erd
\end_inset

 between the 
\begin_inset Formula $O\left(1\right)$
\end_inset

 clusters.
 Fix some 
\begin_inset Formula $V_{i}^{1}$
\end_inset

 and 
\begin_inset Formula $V_{j}^{2}$
\end_inset

, with 
\begin_inset Formula $i,j\ge1$
\end_inset

.
 The vertices of each 
\begin_inset Formula $V_{i}^{1}$
\end_inset

 are matched by 
\begin_inset Formula $M$
\end_inset

 to at most 
\begin_inset Formula $an$
\end_inset

 vertices; conditioning on their number, these are uniformly randomly chosen
 from 
\begin_inset Formula $B$
\end_inset

.
 The number of such vertices in 
\begin_inset Formula $V_{j}^{2}$
\end_inset

 is then hypergeometrically distributed, so with probability 
\begin_inset Formula $1-e^{\Omega\left(n\right)}$
\end_inset

 (see for example 
\begin_inset CommandInset citation
LatexCommand cite
after "Theorem 2.10"
key "JLR00"

\end_inset

) there are at least 
\begin_inset Formula $\left(ab+\xi\left(\alpha\right)\right)n$
\end_inset

 edges of 
\begin_inset Formula $M$
\end_inset

 between 
\begin_inset Formula $V_{i}^{1}$
\end_inset

 and 
\begin_inset Formula $V_{j}^{2}$
\end_inset

.
 By a union bound, a.a.s.
 there are at most 
\begin_inset Formula $\left(ab+\xi\left(\alpha\right)\right)n$
\end_inset

 edges of 
\begin_inset Formula $M$
\end_inset

 between every pair 
\begin_inset Formula $V_{i}^{1}$
\end_inset

, 
\begin_inset Formula $V_{j}^{2}$
\end_inset

.
 That is, 
\begin_inset Formula $M$
\end_inset

 spreads out evenly between the clusters.
 We assume this holds for the remainder of the proof.
\end_layout

\begin_layout Proof
Consider any 
\begin_inset Formula $W\subset A$
\end_inset

 with 
\begin_inset Formula $\alpha n\le\left|W\right|\le\left(1-\alpha\right)n$
\end_inset

.
 For each 
\begin_inset Formula $i$
\end_inset

 let 
\begin_inset Formula $\pi_{i}=\left|V_{i}^{1}\cap W\right|/\left(an\right)$
\end_inset

, and let 
\begin_inset Formula $D$
\end_inset

 be the set of clusters 
\begin_inset Formula $V_{i}^{1}$
\end_inset

 with 
\begin_inset Formula $\pi_{i}\ge\varepsilon$
\end_inset

.
 If 
\begin_inset Formula $\varepsilon$
\end_inset

 is small, 
\begin_inset Formula $D$
\end_inset

 must be nonempty.
 Now, if 
\begin_inset Formula $V_{j}^{2}\in N_{C}\left(D\right)$
\end_inset

 then by 
\begin_inset Formula $\varepsilon$
\end_inset

-regularity there are edges in 
\begin_inset Formula $G'$
\end_inset

 from 
\begin_inset Formula $W$
\end_inset

 to at least 
\begin_inset Formula $\left(1-\varepsilon\right)bn$
\end_inset

 vertices of 
\begin_inset Formula $V_{j}^{2}$
\end_inset

.
 It follows that if 
\begin_inset Formula $\left|N_{C}\left(D\right)\right|=k$
\end_inset

 (as would occur if 
\begin_inset Formula $G$
\end_inset

 was well-distributed) then 
\begin_inset Formula $\left|N_{G\cup M}\left(W\right)\right|\ge\left|N_{G'}\left(W\right)\right|\ge\left(1-\varepsilon\right)\left(n-\left|V_{0}^{2}\right|\right)\ge\left|W\right|$
\end_inset

 for small 
\begin_inset Formula $\varepsilon$
\end_inset

, and we are done.
\end_layout

\begin_layout Proof
Otherwise, choose 
\begin_inset Formula $E\subseteq N\left(D\right)$
\end_inset

 with 
\begin_inset Formula $\left|E\right|=\alpha'k$
\end_inset

 and let 
\begin_inset Formula $S$
\end_inset

 contain the vertices in the clusters of 
\begin_inset Formula $E$
\end_inset

.
 By the same 
\begin_inset Formula $\varepsilon$
\end_inset

-regularity argument, 
\begin_inset Formula $\left|N_{G'}\left(W\right)\cap S\right|\ge\alpha'k\left(1-\varepsilon\right)bn\ge\left(1-\varepsilon\right)^{2}\alpha'n$
\end_inset

.
 Since 
\begin_inset Formula $\left|N_{C}\left(D\right)\right|<k$
\end_inset

, there is 
\begin_inset Formula $V_{j}^{2}$
\end_inset

 outside 
\begin_inset Formula $N_{C}\left(D\right)$
\end_inset

, and this 
\begin_inset Formula $V_{j}^{2}$
\end_inset

 must have 
\begin_inset Formula $\alpha'k$
\end_inset

 neighbours outside 
\begin_inset Formula $D$
\end_inset

 in 
\begin_inset Formula $C$
\end_inset

, so 
\begin_inset Formula $\left|D\right|\le\left(1-\alpha'\right)k$
\end_inset

.
 Since 
\begin_inset Formula $\left|M\right|=\left(1-\xi\left(\alpha\right)\right)n$
\end_inset

, each 
\begin_inset Formula $V_{i}^{1}\cap W$
\end_inset

 has at least 
\begin_inset Formula $\left(\pi_{i}a-\xi\left(\alpha\right)\right)n$
\end_inset

 neighbours in 
\begin_inset Formula $M$
\end_inset

, and at most 
\begin_inset Formula $\alpha'k\left(ab+\xi\left(\alpha\right)\right)n$
\end_inset

 of these are in 
\begin_inset Formula $S$
\end_inset

.
 So, 
\begin_inset Formula 
\begin{align*}
\left|N_{M}\left(W\right)\backslash S\right| & \ge\sum_{V_{i}^{1}\in D}\left(\pi_{i}a-\xi\left(\alpha\right)\right)n-\left|D\right|\left(\alpha'k\left(ab+\xi\left(\alpha\right)\right)\right)n\\
 & \ge\left|W\right|-\varepsilon n-\left(1-\alpha'\right)\alpha'\left(1-\varepsilon\right)^{2}-k^{2}\xi\left(\alpha\right)n
\end{align*}

\end_inset

and
\begin_inset Formula 
\[
\left|N_{G\cup M}\left(W\right)\right|\ge\left|W\right|+\left(\alpha'\left(1-\varepsilon\right)^{2}-\varepsilon-\left(1-\alpha'\right)\alpha'\left(1-\varepsilon\right)^{2}-k^{2}\xi\left(\alpha\right)\right)n.
\]

\end_inset


\end_layout

\begin_layout Proof
If 
\begin_inset Formula $\varepsilon$
\end_inset

 is chosen to be small enough relative to 
\begin_inset Formula $\alpha$
\end_inset

 and 
\begin_inset Formula $\xi\left(\alpha\right)$
\end_inset

 chosen to be small enough relative to 
\begin_inset Formula $K$
\end_inset

, then this gives 
\begin_inset Formula $\left|N_{G\cup M}\left(W\right)\right|\ge\left|W\right|$
\end_inset

.
\end_layout

\begin_layout Standard
Now we describe the reduction of 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:tournament"

\end_inset

 to 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:bipartite-plus-big-matching-perfect"

\end_inset

.
 Consider a 
\begin_inset Formula $k$
\end_inset

-uniform hypergraph 
\begin_inset Formula $H$
\end_inset

.
 Suppose 
\begin_inset Formula $A$
\end_inset

 is a set of 
\begin_inset Formula $n$
\end_inset

 vertices and 
\begin_inset Formula $B$
\end_inset

 is a 
\begin_inset Formula $\left(k-1\right)$
\end_inset

-uniform hypergraph on the remaining vertices.
 Then we define a bipartite graph 
\begin_inset Formula $G_{A,B}\left(H\right)$
\end_inset

 as follows.
 The vertices of 
\begin_inset Formula $G_{A,B}\left(H\right)$
\end_inset

 are the vertices in 
\begin_inset Formula $A$
\end_inset

, as well as the edges in 
\begin_inset Formula $B$
\end_inset

 (we abuse notation and identify the hypergraph 
\begin_inset Formula $B$
\end_inset

 with its edge set).
 We put an edge between 
\begin_inset Formula $a\in A$
\end_inset

 and 
\begin_inset Formula $\left\{ b_{1},\dots,b_{k-1}\right\} \in B$
\end_inset

 if 
\begin_inset Formula $\left\{ a,b_{1},\dots,b_{k-1}\right\} $
\end_inset

 is an edge in 
\begin_inset Formula $H$
\end_inset

.
\end_layout

\begin_layout Standard
The significance of 
\begin_inset Formula $G_{A,B}\left(H\right)$
\end_inset

 is that if 
\begin_inset Formula $B$
\end_inset

 is a perfect matching or loose Hamilton cycle on 
\begin_inset Formula $V\left(H\right)\backslash A$
\end_inset

, and if 
\begin_inset Formula $G_{A,B}\left(H\right)$
\end_inset

 has a large matching 
\begin_inset Formula $M$
\end_inset

, then the edges of 
\begin_inset Formula $M$
\end_inset

 correspond to a large matching (respectively, a large sub-cycle) in 
\begin_inset Formula $H$
\end_inset

.
 Conversely, if 
\begin_inset Formula $H$
\end_inset

 has a large matching or Hamilton cycle (as provided by 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:hypergraph-almost-object"

\end_inset

), then there is a set 
\begin_inset Formula $A$
\end_inset

 and a perfect matching (respectively, loose Hamilton cycle) 
\begin_inset Formula $B$
\end_inset

 such that 
\begin_inset Formula $G_{A,B}\left(H\right)$
\end_inset

 has a large matching.
\end_layout

\begin_layout Standard
By the symmetry of the distribution of 
\begin_inset Formula $R$
\end_inset

, we can assume 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 are uniformly random.
 We give one final lemma, establishing that the density of 
\begin_inset Formula $H$
\end_inset

 corresponds a.a.s.
 to density of 
\begin_inset Formula $G_{A,B}\left(H\right)$
\end_inset

.
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:hypergraph-bipartite-degree-transfer"

\end_inset


\begin_inset Formula $ $
\end_inset


\end_layout

\begin_layout Lemma
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{enumerate}[topsep=0px,label=(
\backslash
alph*)]
\end_layout

\end_inset


\end_layout

\begin_layout Lemma
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
item{
\end_layout

\end_inset

There is 
\begin_inset Formula $\amat\left(\alpha\right)>0$
\end_inset

 such that the following holds.
 Let 
\begin_inset Formula $H$
\end_inset

 satisfy the conditions of 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:hypergraph-theorems"

\end_inset

(a), let 
\begin_inset Formula $A$
\end_inset

 be a uniformly random set of 
\begin_inset Formula $n$
\end_inset

 vertices, and let 
\begin_inset Formula $B$
\end_inset

 be a uniformly random perfect matching on 
\begin_inset Formula $V\left(H\right)\backslash A$
\end_inset

.
 Then a.a.s.
 
\begin_inset Formula $G_{A,B}\left(H\right)$
\end_inset

 has minimum degree 
\begin_inset Formula $\amat\left(\alpha\right)n$
\end_inset

.
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Lemma
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
item{
\end_layout

\end_inset

There is 
\begin_inset Formula $\aham\left(\alpha\right)>0$
\end_inset

 such that the following holds.
 Let 
\begin_inset Formula $H$
\end_inset

 satisfy the conditions of 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:hypergraph-theorems"

\end_inset

(b), let 
\begin_inset Formula $A$
\end_inset

 be a uniformly random set of 
\begin_inset Formula $n$
\end_inset

 vertices, and let 
\begin_inset Formula $B$
\end_inset

 be a uniformly random loose Hamilton cycle on 
\begin_inset Formula $V\left(H\right)\backslash A$
\end_inset

.
 Then a.a.s.
 
\begin_inset Formula $G_{A,B}\left(H\right)$
\end_inset

 has minimum degree 
\begin_inset Formula $\aham\left(\alpha\right)n$
\end_inset

.
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Lemma
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{enumerate}
\end_layout

\end_inset


\end_layout

\begin_layout Proof
\begin_inset ERT
status open

\begin_layout Plain Layout

[Proof of 
\backslash
ref{lem:hypergraph-bipartite-degree-transfer}(a)]
\end_layout

\end_inset

It is helpful to conceptualize the randomness in a certain way.
 Let 
\begin_inset Formula 
\[
a_{1},\dots,a_{n},\, b_{1}^{1},\dots,b_{k}^{1},\, b_{1}^{2},\dots,b_{k}^{n}
\]

\end_inset

be a uniformly random ordering of 
\begin_inset Formula $V\left(H\right)$
\end_inset

.
 Let 
\begin_inset Formula $A=\left\{ a_{1},\dots,a_{n}\right\} $
\end_inset

, let 
\begin_inset Formula $b^{i}=\left\{ b_{1}^{i},\dots,b_{k}^{i}\right\} $
\end_inset

 and let 
\begin_inset Formula $B=\left\{ b^{1},\dots,b^{n}\right\} $
\end_inset

.
\end_layout

\begin_layout Proof
First, condition on some 
\begin_inset Formula $b=b^{i}$
\end_inset

.
 Note that 
\begin_inset Formula $\Pr\left(b\cup\left\{ a_{1}\right\} \in E\left(H\right)\right)\ge\delta_{k-1}\left(H\right)/n$
\end_inset

 and more generally
\begin_inset Formula 
\[
\Pr\left(b\cup\left\{ a_{j}\right\} \in E\left(H\right)\mid a_{1},\dots,a_{j}\right)\ge\left(\delta_{k-1}\left(H\right)-j\right)/n\ge\alpha/2
\]

\end_inset

for 
\begin_inset Formula $j\le\alpha n/2$
\end_inset

.
 By a Chernoff bound, 
\begin_inset Formula $d_{G_{H}}\left(b\right)\ge\alpha^{2}n/8$
\end_inset

 with probability 
\begin_inset Formula $1-e^{-\Omega\left(n\right)}$
\end_inset

.
 With a union bound, this a.a.s.
 holds for all 
\begin_inset Formula $b$
\end_inset

.
\end_layout

\begin_layout Proof
Now, 
\begin_inset Formula $\delta_{1}\left(H\right)\ge\alpha'n^{k-1}$
\end_inset

 for some 
\begin_inset Formula $\alpha'$
\end_inset

 depending on 
\begin_inset Formula $\alpha$
\end_inset

.
 Condition on some 
\begin_inset Formula $a=a_{i}$
\end_inset

.
 Each 
\begin_inset Formula $b_{j}^{i}$
\end_inset

 shares at most 
\begin_inset Formula ${n \choose k-2}$
\end_inset

 edges with 
\begin_inset Formula $a_{i}$
\end_inset

, so if 
\begin_inset Formula $j\le2\sqrt{\amat\left(\alpha\right)}n$
\end_inset

 for sufficently small 
\begin_inset Formula $\amat\left(\alpha\right)$
\end_inset

 and large 
\begin_inset Formula $n$
\end_inset

, then 
\begin_inset Formula 
\[
\Pr\left(\left\{ a\right\} \cup b^{j+1}\in E\left(H\right)\mid b^{1},\dots,b^{j}\right)\ge\left(\delta_{1}\left(H\right)-kj{n \choose k-2}\right)\left.\vphantom{\sum}\right/{n \choose k-1}\ge\sqrt{\amat\left(\alpha\right)}.
\]

\end_inset


\end_layout

\begin_layout Proof
By a Chernoff bound and a union bound, a.a.s.
 each 
\begin_inset Formula $d_{G_{H}}\left(a\right)\ge\amat\left(\alpha\right)n$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Proof
\begin_inset ERT
status open

\begin_layout Plain Layout

[Proof of 
\backslash
ref{lem:hypergraph-bipartite-degree-transfer}(b)]
\end_layout

\end_inset

We give essentially the same proof as for 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:hypergraph-bipartite-degree-transfer"

\end_inset

(a).
 Choose a uniformly random ordering of 
\begin_inset Formula $V\left(H\right)$
\end_inset

: 
\begin_inset Formula 
\[
a_{1},\dots,a_{n},b_{0},\dots,b_{\left(k-2\right)n-1}.
\]

\end_inset

Let 
\begin_inset Formula $A=\left\{ a_{1},\dots,a_{n}\right\} $
\end_inset

, let 
\begin_inset Formula $b^{i}=\left\{ b_{\left(k-2\right)i},b_{\left(k-2\right)i+1},\dots,b_{\left(k-2\right)\left(i+1\right)}\right\} $
\end_inset

 (where the subscripts are interpreted modulo 
\begin_inset Formula $\left(k-2\right)n$
\end_inset

), and let 
\begin_inset Formula $B=\left\{ b^{1},\dots,b^{n}\right\} $
\end_inset

.
\end_layout

\begin_layout Proof
With exactly the same proof as for 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:hypergraph-bipartite-degree-transfer"

\end_inset

(a), there is small 
\begin_inset Formula $\aham\left(\alpha\right)$
\end_inset

 such that a.a.s.
 
\begin_inset Formula $d_{G_{H}}\left(b\right)\ge\aham\left(\alpha\right)n$
\end_inset

 for all 
\begin_inset Formula $b$
\end_inset

.
 Next, condition on some 
\begin_inset Formula $a=a_{i}$
\end_inset

.
 For small 
\begin_inset Formula $\zeta\left(\alpha\right)$
\end_inset

 and 
\begin_inset Formula $j\le2\sqrt{\aham\left(\alpha\right)}n$
\end_inset

, 
\begin_inset Formula 
\[
\Pr\left(\left\{ a\right\} \cup b^{j}\in E\left(H\right)\mid b^{0},\dots,b^{j-1}\right)\ge\left(\delta_{2}\left(H\right)-\left(k-2\right)j{n \choose k-3}\right)\left.\vphantom{\sum}\right/{n \choose k-2}\ge\sqrt{\aham\left(\alpha\right)},
\]

\end_inset


\end_layout

\begin_layout Proof
so a.a.s.
 each 
\begin_inset Formula $d_{G_{H}}\left(a\right)\ge\aham\left(\alpha\right)n$
\end_inset

.
\end_layout

\begin_layout Standard
We have established that 
\begin_inset Formula $G_{A,B}\left(H\right)$
\end_inset

 is a bipartite graph with linear minimum degree.
 If we condition on 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

, then 
\begin_inset Formula $G_{A,B}\left(R\right)$
\end_inset

 a.a.s.
 provides a uniformly random large matching between 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

, so 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:bipartite-plus-big-matching-perfect"

\end_inset

 ensures the existence of a perfect matching in 
\begin_inset Formula $G_{A,B}\left(H\cup R\right)$
\end_inset

, corresponding to a perfect matching or loose Hamilton cycle in 
\begin_inset Formula $H\cup R$
\end_inset

.
\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sec:digraphs"

\end_inset

Pancyclicity in dense digraphs
\end_layout

\begin_layout Standard
In this section we prove 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:pseudorandom-pancyclic"

\end_inset

, and as a corollary we also prove the following theorem.
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:smoothed-pancyclic"

\end_inset

Let 
\begin_inset Formula $\DD\left(n,m\right)$
\end_inset

 be the uniform distribution on (not necessarily oriented) 
\begin_inset Formula $n$
\end_inset

-vertex, 
\begin_inset Formula $m$
\end_inset

-arc digraphs.
 For each 
\begin_inset Formula $\alpha>0$
\end_inset

, there is 
\begin_inset Formula $\cdi\left(\alpha\right)$
\end_inset

 such that if 
\begin_inset Formula $D$
\end_inset

 is a digraph with all in- and out- degrees at least 
\begin_inset Formula $\alpha n$
\end_inset

, and 
\begin_inset Formula $R\in\DD\left(n,\cdi\left(\alpha\right)n\right)$
\end_inset

, then 
\begin_inset Formula $D\cup R$
\end_inset

 is a.a.s.
 pancyclic.
\end_layout

\begin_layout Standard
One motivation for this theorem is an observation by Bondy (see 
\begin_inset CommandInset citation
LatexCommand cite
key "Bon75"

\end_inset

), that almost all known non-trivial conditions that ensure Hamiltonicity
 also ensure pancyclicity.
 He made an informal 
\begin_inset Quotes eld
\end_inset

metaconjecture
\begin_inset Quotes erd
\end_inset

 that this was always the case; our 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:smoothed-pancyclic"

\end_inset

 verifies his metaconjecture in the setting of randomly perturbed dense
 graphs and digraphs.
\end_layout

\begin_layout Standard
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:smoothed-pancyclic"

\end_inset

 obviously implies 
\begin_inset CommandInset citation
LatexCommand cite
after "Theorems~1 and~3"
key "BFM03"

\end_inset

.
 We do not fight very hard to optimize constants, but we note that if we
 make some simplifications in the proof of 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:smoothed-pancyclic"

\end_inset

, the resulting values of 
\begin_inset Formula $\cdi\left(\alpha\right)$
\end_inset

 seem to be better than those found in 
\begin_inset CommandInset citation
LatexCommand cite
key "BFM03"

\end_inset

, for most values of 
\begin_inset Formula $\alpha$
\end_inset

.
\end_layout

\begin_layout Standard
We now turn to the proof of 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:pseudorandom-pancyclic"

\end_inset

, which will follow from the corresponding result for Hamiltonicity.
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:pseudorandom-hamiltonian"

\end_inset

Let 
\begin_inset Formula $D$
\end_inset

 be a directed graph with all in- and out- degrees at least 
\begin_inset Formula $4k$
\end_inset

, and suppose for all disjoint 
\begin_inset Formula $A,B\subseteq V\left(D\right)$
\end_inset

 with 
\begin_inset Formula $\left|A\right|=\left|B\right|\ge k$
\end_inset

, there is an arc from 
\begin_inset Formula $A$
\end_inset

 to 
\begin_inset Formula $B$
\end_inset

.
 Then 
\begin_inset Formula $D$
\end_inset

 is Hamiltonian.
\end_layout

\begin_layout Remark
\begin_inset CommandInset label
LatexCommand label
name "rem:constants"

\end_inset

With some effort, the ideas in the proof of 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:pseudorandom-hamiltonian"

\end_inset

 can be used directly to prove  
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:pseudorandom-pancyclic"

\end_inset

 with a weaker degree condition.
 We do not know whether the condition can be weakened all the way to 
\begin_inset Formula $4k$
\end_inset

, as Bondy's metaconjecture would suggest.
 The constants in 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ref{lem:pseudorandom-pancyclic,lem:pseudorandom-hamiltonian}
\end_layout

\end_inset

 can both be halved for the undirected case, just by simplifying the main
 argument in the proof of 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:pseudorandom-hamiltonian"

\end_inset

.
\end_layout

\begin_layout Remark
The idea of the proof is to start with a longest path 
\begin_inset Formula $P$
\end_inset

 and manipulate it into a cycle 
\begin_inset Formula $C$
\end_inset

 on the same vertex set.
 We will show that 
\begin_inset Formula $D$
\end_inset

 is strongly connected, so if 
\begin_inset Formula $C$
\end_inset

 were not Hamiltonian, there would be an arc from 
\begin_inset Formula $V\left(C\right)$
\end_inset

 to its complement, which could be combined with 
\begin_inset Formula $C$
\end_inset

 to give a longer path than 
\begin_inset Formula $P$
\end_inset

, contradicting maximality.
 This type of argument goes back to the proof of Dirac's theorem 
\begin_inset CommandInset citation
LatexCommand cite
after "Theorem~3"
key "Dir52"

\end_inset

.
 It also bears some resemblance to the 
\begin_inset Quotes eld
\end_inset

rotation-extension
\begin_inset Quotes erd
\end_inset

 idea introduced in 
\begin_inset CommandInset citation
LatexCommand cite
key "Pos76"

\end_inset

, and a variation for directed graphs in 
\begin_inset CommandInset citation
LatexCommand cite
after "Section~4.3"
key "FK05"

\end_inset

.
\end_layout

\begin_layout Proof
\begin_inset ERT
status open

\begin_layout Plain Layout

[Proof of 
\backslash
ref{lem:pseudorandom-hamiltonian}]
\end_layout

\end_inset

First we acknowledge some immediate consequences of the condition on 
\begin_inset Formula $D$
\end_inset

.
 Note that if 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 are disjoint sets with size at least 
\begin_inset Formula $k$
\end_inset

, then in fact there are 
\begin_inset Formula $\left|A\right|-k$
\end_inset

 vertices of 
\begin_inset Formula $A$
\end_inset

 with an arc into 
\begin_inset Formula $B$
\end_inset

.
 To see this, note that for any fewer number of such vertices in 
\begin_inset Formula $A$
\end_inset

, we can delete those vertices and at least 
\begin_inset Formula $k$
\end_inset

 will remain, one of which has an arc to 
\begin_inset Formula $B$
\end_inset

.
 Also, 
\begin_inset Formula $D$
\end_inset

 is strongly connected.
 To see this, note that for any 
\begin_inset Formula $v,w$
\end_inset

, both of 
\begin_inset Formula $N^{+}\left(v\right)$
\end_inset

 and 
\begin_inset Formula $N^{-}\left(w\right)$
\end_inset

 have size at least 
\begin_inset Formula $4k>k$
\end_inset

.
 If they intersect then there is a length-2 path from 
\begin_inset Formula $v$
\end_inset

 to 
\begin_inset Formula $w$
\end_inset

; otherwise there must be an arc from 
\begin_inset Formula $N^{+}\left(v\right)$
\end_inset

 to 
\begin_inset Formula $N^{-}\left(w\right)$
\end_inset

 giving a length-3 path.
\end_layout

\begin_layout Proof
Let 
\begin_inset Formula $P=u\dots w$
\end_inset

 be a maximal-length directed path in 
\begin_inset Formula $D$
\end_inset

.
 We will use the notation 
\begin_inset Formula $v^{+}$
\end_inset

 (respectively 
\begin_inset Formula $v^{-}$
\end_inset

) for the successor (respectively predecessor) of a vertex 
\begin_inset Formula $v$
\end_inset

 on 
\begin_inset Formula $P$
\end_inset

, and also write 
\begin_inset Formula $V^{+},V^{-}$
\end_inset

 for the set of successors or predecessors of a set of vertices 
\begin_inset Formula $V$
\end_inset

.
\end_layout

\begin_layout Proof
By maximality, 
\begin_inset Formula $N^{+}\left(w\right)\subset P$
\end_inset

 and 
\begin_inset Formula $N^{-}\left(u\right)\subset P$
\end_inset

.
 Let 
\begin_inset Formula $U_{1}$
\end_inset

 be the first 
\begin_inset Formula $3k$
\end_inset

 elements of 
\begin_inset Formula $N^{-}\left(u\right)$
\end_inset

 on 
\begin_inset Formula $P$
\end_inset

, and let 
\begin_inset Formula $U_{2}$
\end_inset

 be the last 
\begin_inset Formula $k$
\end_inset

 (note 
\begin_inset Formula $U_{1}\cap U_{2}=\varnothing$
\end_inset

).
 Similarly let 
\begin_inset Formula $W_{1}$
\end_inset

 be the first 
\begin_inset Formula $k$
\end_inset

 and 
\begin_inset Formula $W_{2}$
\end_inset

 the last 
\begin_inset Formula $3k$
\end_inset

 elements of 
\begin_inset Formula $N^{+}\left(w\right)$
\end_inset

.
 We will now show that there is a cycle on the vertex set 
\begin_inset Formula $V\left(P\right)$
\end_inset

.
\end_layout

\begin_layout Proof
First, consider the case where each vertex of 
\begin_inset Formula $W_{1}$
\end_inset

 precedes each vertex of 
\begin_inset Formula $U_{2}$
\end_inset

.
 If 
\begin_inset Formula $wu$
\end_inset

 is in 
\begin_inset Formula $D$
\end_inset

 then we can immediately close 
\begin_inset Formula $P$
\end_inset

 into a cycle.
 Otherwise, 
\begin_inset Formula $\left|W_{1}^{-}\right|=\left|W_{1}\right|=\left|U_{2}^{+}\right|=\left|U_{2}\right|=k$
\end_inset

, so there is an arc 
\begin_inset Formula $w_{1}u_{2}$
\end_inset

 from 
\begin_inset Formula $W_{1}^{-}$
\end_inset

 to 
\begin_inset Formula $U_{2}^{+}$
\end_inset

.
 This is enough to piece together a cycle on 
\begin_inset Formula $V\left(P\right)$
\end_inset

: start at 
\begin_inset Formula $u_{2}$
\end_inset

 and move along 
\begin_inset Formula $P$
\end_inset

 to 
\begin_inset Formula $w$
\end_inset

, from where there is a shortcut back to 
\begin_inset Formula $w_{1}^{+}$
\end_inset

.
 Now move along 
\begin_inset Formula $P$
\end_inset

 from 
\begin_inset Formula $w_{1}^{+}$
\end_inset

 to 
\begin_inset Formula $u_{2}^{-}$
\end_inset

, from where we can jump back to 
\begin_inset Formula $u$
\end_inset

, then move along 
\begin_inset Formula $P$
\end_inset

 to 
\begin_inset Formula $w_{1}$
\end_inset

, then jump to 
\begin_inset Formula $u_{2}$
\end_inset

.
 See Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:pseudorandom-hamiltonian-case-1"

\end_inset

 for an illustration.
\end_layout

\begin_layout Proof
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{center}
\end_layout

\begin_layout Plain Layout


\backslash
hspace{0.5cm}
\end_layout

\begin_layout Plain Layout


\backslash
begin{tikzpicture}[scale=0.95]
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (u) at  (0,0) {};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (w1) at  (4.5,0) {};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (w1p) at  (5,0) {};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (u2m) at  (10,0) {};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (u2) at (10.5,0) {};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (w) at (15.5,0) {};
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
draw (u) to (0.5,0);
\end_layout

\begin_layout Plain Layout


\backslash
draw[arc,dashed] (u) to (w1);
\end_layout

\begin_layout Plain Layout


\backslash
draw (4,0) to (w1);
\end_layout

\begin_layout Plain Layout


\backslash
draw (w1) to (w1p);
\end_layout

\begin_layout Plain Layout


\backslash
draw (w1p) to (5.5,0);
\end_layout

\begin_layout Plain Layout


\backslash
draw[arc,dashed] (w1p) to (u2m);
\end_layout

\begin_layout Plain Layout


\backslash
draw (9.5,0) to (u2m);
\end_layout

\begin_layout Plain Layout


\backslash
draw (u2m) to (u2);
\end_layout

\begin_layout Plain Layout


\backslash
draw (u2) to (11,0);
\end_layout

\begin_layout Plain Layout


\backslash
draw[arc,dashed] (u2) to (w);
\end_layout

\begin_layout Plain Layout


\backslash
draw (15,0) to (w);
\end_layout

\begin_layout Plain Layout


\backslash
draw[arc] (w) to [bend right] (w1p);
\end_layout

\begin_layout Plain Layout


\backslash
draw[arc] (u2m)  to [bend right] (u);
\end_layout

\begin_layout Plain Layout


\backslash
draw[arc] (w1) to [bend right] (u2);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

%
\backslash
draw[line width=5, opacity=0.3, blue] (u) to (w1) to [bend right] (u2) to
 (w) to [bend right] (w1p) to (u2m) to [bend right] (u);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
node at (4.6,-0.5){$w_1^{
\backslash
phantom+}$};
\end_layout

\begin_layout Plain Layout


\backslash
node at (5.1,0.5){$w_1^+$};
\end_layout

\begin_layout Plain Layout


\backslash
node at (10.1,0.5){$u_2^-$};
\end_layout

\begin_layout Plain Layout


\backslash
node at (10.6,-0.5){$u_2^{
\backslash
phantom-}$};
\end_layout

\begin_layout Plain Layout


\backslash
node at (0,-0.5){$u$};
\end_layout

\begin_layout Plain Layout


\backslash
node at (15.5,-0.5){$w$};
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
end{tikzpicture}
\end_layout

\begin_layout Plain Layout


\backslash
hspace{0.5cm}
\end_layout

\begin_layout Plain Layout


\backslash
end{center}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:pseudorandom-hamiltonian-case-1"

\end_inset

The case where the vertices of 
\begin_inset Formula $W_{1}$
\end_inset

 precede the vertices of 
\begin_inset Formula $U_{2}$
\end_inset

.
 The horizontal line through the center is 
\begin_inset Formula $P$
\end_inset

; the broken lines indicate subpaths.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Proof
Otherwise, each vertex of 
\begin_inset Formula $U_{1}$
\end_inset

 precedes each vertex of 
\begin_inset Formula $W_{2}$
\end_inset

.
 Let 
\begin_inset Formula $U_{12}$
\end_inset

 contain the 
\begin_inset Formula $k$
\end_inset

 elements of 
\begin_inset Formula $U_{1}$
\end_inset

 furthest down the path.
 Let 
\begin_inset Formula $U_{11}$
\end_inset

 be the set of vertices among the first 
\begin_inset Formula $2k$
\end_inset

 vertices of 
\begin_inset Formula $P$
\end_inset

 which have an arc to 
\begin_inset Formula $U_{12}^{+}$
\end_inset

.
 By the discussion at the beginning of the proof, 
\begin_inset Formula $\left|U_{11}\right|\ge k$
\end_inset

.
 Similarly, let 
\begin_inset Formula $W_{21}$
\end_inset

 contain the 
\begin_inset Formula $k$
\end_inset

 elements of 
\begin_inset Formula $W_{2}$
\end_inset

 first appearing on the path, and let 
\begin_inset Formula $W_{22}$
\end_inset

 be the set of at least 
\begin_inset Formula $k$
\end_inset

 vertices among the last 
\begin_inset Formula $2k$
\end_inset

 on 
\begin_inset Formula $P$
\end_inset

 which have an arc from 
\begin_inset Formula $W_{21}^{-}$
\end_inset

.
 By the condition on 
\begin_inset Formula $D$
\end_inset

, there is an arc 
\begin_inset Formula $w_{22}u_{11}$
\end_inset

 from 
\begin_inset Formula $W_{22}^{-}$
\end_inset

 to 
\begin_inset Formula $U_{11}^{+}$
\end_inset

.
 By definition, there is 
\begin_inset Formula $u_{12}\in U_{12}^{+}$
\end_inset

 and 
\begin_inset Formula $w_{21}\in W_{21}^{-}$
\end_inset

 such that the arcs 
\begin_inset Formula $u_{11}^{-}u_{12}$
\end_inset

 and 
\begin_inset Formula $w_{21}w_{22}^{+}$
\end_inset

 are in 
\begin_inset Formula $D$
\end_inset

.
 We can piece everything together to get a cycle on the vertices of 
\begin_inset Formula $P$
\end_inset

: start at 
\begin_inset Formula $u_{11}$
\end_inset

, move along 
\begin_inset Formula $P$
\end_inset

 until 
\begin_inset Formula $u_{12}^{-}$
\end_inset

, then jump back to 
\begin_inset Formula $u$
\end_inset

.
 Move along 
\begin_inset Formula $P$
\end_inset

 until 
\begin_inset Formula $u_{11}^{-}$
\end_inset

, then take the shortcut to 
\begin_inset Formula $u_{12}$
\end_inset

.
 Continue along 
\begin_inset Formula $P$
\end_inset

 to 
\begin_inset Formula $w_{21}$
\end_inset

, jump to 
\begin_inset Formula $w_{22}^{+}$
\end_inset

, continue to 
\begin_inset Formula $w$
\end_inset

, jump back to 
\begin_inset Formula $w_{21}^{+}$
\end_inset

, and continue to 
\begin_inset Formula $w_{22}$
\end_inset

.
 From here there is a shortcut back to 
\begin_inset Formula $u_{11}$
\end_inset

.
 See Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:pseudorandom-hamiltonian-case-2"

\end_inset

.
\end_layout

\begin_layout Proof
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{center}
\end_layout

\begin_layout Plain Layout


\backslash
hspace{0.5cm}
\end_layout

\begin_layout Plain Layout


\backslash
begin{tikzpicture}[scale=0.95]
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (u) at  (0,0) {};
\end_layout

\begin_layout Plain Layout


\backslash
node (up) at  (0.5,0) {};
\end_layout

\begin_layout Plain Layout


\backslash
node (u11mm) at  (2.5,0) {};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (u11m) at  (3,0) {};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (u11) at  (3.5,0) {};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (u12m) at  (6.5,0) {};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (u12) at  (7,0) {};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (w21) at  (10,0) {};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (w21p) at  (10.5,0) {};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (w22) at  (13.5,0) {};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (w22p) at  (14,0) {};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (w) at  (17,0) {};
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
draw (u) to (0.5,0);
\end_layout

\begin_layout Plain Layout


\backslash
draw[arc,dashed] (u) to (u11m);
\end_layout

\begin_layout Plain Layout


\backslash
draw (2.5,0) to (u11m);
\end_layout

\begin_layout Plain Layout


\backslash
draw (u11m) to (u11);
\end_layout

\begin_layout Plain Layout


\backslash
draw (u11) to (4,0);
\end_layout

\begin_layout Plain Layout


\backslash
draw[arc,dashed] (u11) to (u12m);
\end_layout

\begin_layout Plain Layout


\backslash
draw (u12m) to (6,0);
\end_layout

\begin_layout Plain Layout


\backslash
draw (u12m) to (u12);
\end_layout

\begin_layout Plain Layout


\backslash
draw (u12) to (7.5,0);
\end_layout

\begin_layout Plain Layout


\backslash
draw[arc,dashed] (u12) to (w21);
\end_layout

\begin_layout Plain Layout


\backslash
draw (9.5,0) to (w21);
\end_layout

\begin_layout Plain Layout


\backslash
draw (w21) to (w21p);
\end_layout

\begin_layout Plain Layout


\backslash
draw (w21p) to (11,0);
\end_layout

\begin_layout Plain Layout


\backslash
draw[arc,dashed] (w21p) to (w22);
\end_layout

\begin_layout Plain Layout


\backslash
draw (13,0) to (w22);
\end_layout

\begin_layout Plain Layout


\backslash
draw (w22) to (w22p);
\end_layout

\begin_layout Plain Layout


\backslash
draw (w22p) to (14.5,0);
\end_layout

\begin_layout Plain Layout


\backslash
draw[arc,dashed] (w22p) to (w);
\end_layout

\begin_layout Plain Layout


\backslash
draw (16.5,0) to (w);
\end_layout

\begin_layout Plain Layout


\backslash
draw[arc] (u12m) to [bend right] (u);
\end_layout

\begin_layout Plain Layout


\backslash
draw[arc] (u11m)  to [bend right] (u12);
\end_layout

\begin_layout Plain Layout


\backslash
draw[arc] (w21) to [bend right] (w22p);
\end_layout

\begin_layout Plain Layout


\backslash
draw[arc] (w) to [bend right] (w21p);
\end_layout

\begin_layout Plain Layout


\backslash
draw[arc] (w22) to [bend right] (u11);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

%
\backslash
draw[line width=5, opacity=0.3, blue] (u) to (w1) to [bend right] (u2) to
 (w) to [bend right] (w1p) to (u2m) to [bend right] (u);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
node at (0,-0.5){$u$};
\end_layout

\begin_layout Plain Layout


\backslash
node at (3.1,-0.5){$u_{11}^-$};
\end_layout

\begin_layout Plain Layout


\backslash
node at (3.6,0.5){$u_{11}^{
\backslash
phantom-}$};
\end_layout

\begin_layout Plain Layout


\backslash
node at (6.6,0.5){$u_{12}^-$};
\end_layout

\begin_layout Plain Layout


\backslash
node at (7.1,-0.5){$u_{12}^{
\backslash
phantom-}$};
\end_layout

\begin_layout Plain Layout


\backslash
node at (10.1,-0.5){$w_{21}^{
\backslash
phantom+}$};
\end_layout

\begin_layout Plain Layout


\backslash
node at (10.6,0.5){$w_{21}^+$};
\end_layout

\begin_layout Plain Layout


\backslash
node at (13.6,0.5){$w_{22}^{
\backslash
phantom+}$};
\end_layout

\begin_layout Plain Layout


\backslash
node at (14.1,-0.5){$w_{22}^+$};
\end_layout

\begin_layout Plain Layout


\backslash
node at (17,-0.5){$w$};
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
end{tikzpicture}
\end_layout

\begin_layout Plain Layout


\backslash
hspace{0.5cm}
\end_layout

\begin_layout Plain Layout


\backslash
end{center}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:pseudorandom-hamiltonian-case-2"

\end_inset

The case where the vertices of 
\begin_inset Formula $U_{1}$
\end_inset

 precede the vertices of 
\begin_inset Formula $W_{2}$
\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Proof
As outlined, the fact that 
\begin_inset Formula $D$
\end_inset

 is strongly connected, combined with the fact that the vertex set of 
\begin_inset Formula $P$
\end_inset

 induces a cycle 
\begin_inset Formula $C$
\end_inset

, implies that 
\begin_inset Formula $C$
\end_inset

 is a Hamilton cycle.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Proof
\begin_inset ERT
status open

\begin_layout Plain Layout

[Proof of 
\backslash
ref{lem:pseudorandom-hamiltonian}]
\end_layout

\end_inset

Fix a vertex 
\begin_inset Formula $v$
\end_inset

.
 Let 
\begin_inset Formula $U^{+}$
\end_inset

 and 
\begin_inset Formula $U^{-}$
\end_inset

 be arbitrary 
\begin_inset Formula $k$
\end_inset

-subsets of 
\begin_inset Formula $N^{+}\left(v\right)$
\end_inset

 and 
\begin_inset Formula $N^{-}\left(v\right)$
\end_inset

 respectively.
 There is an arc from 
\begin_inset Formula $U^{+}$
\end_inset

 to 
\begin_inset Formula $U^{-}$
\end_inset

 which immediately gives a 3-cycle.
\end_layout

\begin_layout Proof
Next, let 
\begin_inset Formula $W^{+}$
\end_inset

 be the set of (fewer than 
\begin_inset Formula $k$
\end_inset

) vertices with no arc into 
\begin_inset Formula $U^{+}$
\end_inset

, and similarly let 
\begin_inset Formula $W^{-}$
\end_inset

 be the set of vertices with no arc from 
\begin_inset Formula $U^{-}$
\end_inset

.
 Now consider the induced digraph 
\begin_inset Formula $D'$
\end_inset

 obtained from 
\begin_inset Formula $D$
\end_inset

 by deleting 
\begin_inset Formula $v$
\end_inset

 and the vertices in 
\begin_inset Formula $U^{+},U^{-},W^{+},W^{-}$
\end_inset

.
 Since we have removed fewer than 
\begin_inset Formula $4k$
\end_inset

 vertices, 
\begin_inset Formula $D'$
\end_inset

 satisfies the conditions of 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:pseudorandom-hamiltonian"

\end_inset

 so has a Hamilton cycle.
 In particular, for every 
\begin_inset Formula $\ell$
\end_inset

 satisfying 
\begin_inset Formula $4\le\ell\le n-4k$
\end_inset

, there is a path 
\begin_inset Formula $P_{\ell}=u_{\ell}\dots w_{\ell}$
\end_inset

 in 
\begin_inset Formula $D'$
\end_inset

 of length 
\begin_inset Formula $\ell-4$
\end_inset

.
 By construction, there is an arc from 
\begin_inset Formula $U^{+}$
\end_inset

 to 
\begin_inset Formula $u_{\ell}$
\end_inset

 and from 
\begin_inset Formula $w_{\ell}$
\end_inset

 to 
\begin_inset Formula $U^{-}$
\end_inset

, which we can combine with arcs to and from 
\begin_inset Formula $v$
\end_inset

 to get a cycle of length 
\begin_inset Formula $\ell$
\end_inset

.
\end_layout

\begin_layout Proof
Finally, for every 
\begin_inset Formula $\ell>n-4k$
\end_inset

, arbitrarily delete vertices from 
\begin_inset Formula $D$
\end_inset

 to obtain an induced digraph 
\begin_inset Formula $D''$
\end_inset

 with 
\begin_inset Formula $\ell$
\end_inset

 vertices which satisfies the conditions of 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:pseudorandom-hamiltonian"

\end_inset

.
 Since 
\begin_inset Formula $D''$
\end_inset

 has a Hamilton cycle, 
\begin_inset Formula $D$
\end_inset

 has a cycle of length 
\begin_inset Formula $\ell$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Proof
\begin_inset ERT
status open

\begin_layout Plain Layout

[Proof of 
\backslash
ref{thm:smoothed-pancyclic}]
\end_layout

\end_inset

In view of the discussion in the introduction, we assume each possible arc
 is present in 
\begin_inset Formula $R$
\end_inset

 with independent probability 
\begin_inset Formula $p=2\cdi\left(\alpha\right)/n$
\end_inset

.
\end_layout

\begin_layout Proof
If 
\begin_inset Formula $A,B\subseteq V\left(D\right)$
\end_inset

 are disjoint sets with 
\begin_inset Formula $\left|A\right|=\left|B\right|=\alpha n/8$
\end_inset

, the probability that there are no arcs from 
\begin_inset Formula $A$
\end_inset

 to 
\begin_inset Formula $B$
\end_inset

 in 
\begin_inset Formula $D\cup R$
\end_inset

 is at most
\begin_inset Formula 
\[
\left(1-p\right)^{\left(\alpha n/8\right)^{2}}\le e^{-p\alpha^{2}n^{2}/64}=e^{-\cdi\left(\alpha\right)\alpha^{2}n/32}.
\]

\end_inset

The number of choices of such pairs of disjoint sets 
\begin_inset Formula $A,B$
\end_inset

 is 
\begin_inset Formula 
\[
{n \choose \alpha n/4}{\alpha n/4 \choose \alpha n/8}=O\left(\frac{1}{\sqrt{n}}e^{n\left(H\left(\alpha/4\right)+\alpha H\left(1/2\right)/4\right)}\right),
\]

\end_inset

where 
\begin_inset Formula $H\left(\alpha\right)=-\alpha\log\alpha-\left(1-\alpha\right)\log\left(1-\alpha\right)$
\end_inset

 (this can be proved with Stirling's approximation).
 By a union bound, the probability that 
\begin_inset Formula $D\cup R$
\end_inset

 does not satisfy the condition of 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:pseudorandom-hamiltonian"

\end_inset

 is at most
\begin_inset Formula 
\[
O\left(\frac{1}{\sqrt{n}}e^{n\left(H\left(\alpha/4\right)+\alpha H\left(1/2\right)/4-\cdi\left(\alpha\right)\alpha^{2}n/32+o\left(1\right)\right)}\right).
\]

\end_inset

This converges to zero if 
\begin_inset Formula $\cdi\left(\alpha\right)$
\end_inset

 is chosen to be sufficiently large.
\end_layout

\begin_layout Remark
If we are only interested in Hamiltonicity, we can use 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:pseudorandom-hamiltonian"

\end_inset

 directly in the proof of 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:smoothed-pancyclic"

\end_inset

, which gives a better constant 
\begin_inset Formula $\cdi\left(\alpha\right)$
\end_inset

 than in 
\begin_inset CommandInset citation
LatexCommand cite
after "Theorem~3"
key "BFM03"

\end_inset

, for all 
\begin_inset Formula $\alpha$
\end_inset

.
 If we make the adjustment for undirected graphs mentioned in 
\begin_inset CommandInset ref
LatexCommand ref
reference "rem:constants"

\end_inset

, then we also beat the corresponding constant in 
\begin_inset CommandInset citation
LatexCommand cite
after "Theorem~1"
key "BFM03"

\end_inset

 except for small values of 
\begin_inset Formula $\alpha$
\end_inset

.
\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sec:tournaments"

\end_inset

Hamilton cycles in tournaments
\end_layout

\begin_layout Standard
There are several seemingly different conditions that are equivalent to
 Hamiltonicity for tournaments (see 
\begin_inset CommandInset citation
LatexCommand cite
after "Chapters~2-3"
key "Moo68"

\end_inset

).
 A tournament is Hamiltonian if and only if it is irreducible (cannot be
 divided into two partitions with all arcs between the two partitions in
 the same direction), if and only if it is strongly connected (has a directed
 path from every vertex to every other), if and only if it is pancyclic
 (contains cycles of all lengths).
 All tournaments have a Hamilton path, and it was first proved in 
\begin_inset CommandInset citation
LatexCommand cite
key "MM62"

\end_inset

 that a uniformly random tournament is a.a.s.
 irreducible, hence Hamiltonian.
\end_layout

\begin_layout Standard
It was more recently proved in 
\begin_inset CommandInset citation
LatexCommand cite
key "KLOP14"

\end_inset

 that if a tournament is 
\begin_inset Formula $t$
\end_inset

-strongly connected (it remains strongly connected after the deletion of
 
\begin_inset Formula $t-1$
\end_inset

 vertices), then it has 
\begin_inset Formula $\Omega\left(\sqrt{t}/\log t\right)$
\end_inset

 arc-disjoint Hamilton cycles (this was improved to 
\begin_inset Formula $\Omega\left(\sqrt{t}\right)$
\end_inset

 in 
\begin_inset CommandInset citation
LatexCommand cite
key "Pok14"

\end_inset

).
 It is not difficult to show that a random tournament is a.a.s.
 
\begin_inset Formula $t$
\end_inset

-connected for fixed 
\begin_inset Formula $t$
\end_inset

, which implies that a random tournament contains 
\begin_inset Formula $q$
\end_inset

 arc-disjoint Hamilton cycles for 
\begin_inset Formula $q=O\left(1\right)$
\end_inset

.
 We will use this to prove 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:tournament"

\end_inset

.
\end_layout

\begin_layout Standard
Before we proceed to the proof, we first explain why 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:tournament"

\end_inset

 is sharp.
 The 
\begin_inset Quotes eld
\end_inset

obvious
\begin_inset Quotes erd
\end_inset

 worst case for 
\begin_inset Formula $T$
\end_inset

 is a 
\emph on
transitive
\emph default
 tournament (corresponding to a linear order on the vertices).
 In this case, a superlinear number of edges must be flipped in order to
 a.a.s.
 flip one of the arcs pointing away from the least element of the linear
 order.
 Actually, the model where random edges are flipped in a transitive tournament
 has already been studied in 
\begin_inset CommandInset citation
LatexCommand cite
key "LRG96"

\end_inset

, by analogy to the evolution of the random graph.
\end_layout

\begin_layout Standard
More generally, consider a 
\begin_inset Quotes eld
\end_inset

transitive cluster-tournament
\begin_inset Quotes erd
\end_inset

 
\begin_inset Formula $T$
\end_inset

 on 
\begin_inset Formula $n=rk$
\end_inset

 vertices defined as follows.
 Let 
\begin_inset Formula $R$
\end_inset

 be a regular tournament on 
\begin_inset Formula $2d+1$
\end_inset

 vertices (this means the indegree and outdegree are equal for each vertex).
 To construct 
\begin_inset Formula $T$
\end_inset

, start with 
\begin_inset Formula $r$
\end_inset

 disjoint copies 
\begin_inset Formula $R_{1},\dots,R_{r}$
\end_inset

 of 
\begin_inset Formula $R$
\end_inset

, then put an arc from 
\begin_inset Formula $v$
\end_inset

 to 
\begin_inset Formula $w$
\end_inset

 for every 
\begin_inset Formula $v\in R_{i}$
\end_inset

, 
\begin_inset Formula $w\in R_{j}$
\end_inset

 with 
\begin_inset Formula $i<j$
\end_inset

.
 In order for the perturbed tournament 
\begin_inset Formula $P$
\end_inset

 to be Hamiltonian, there must be an arc entering 
\begin_inset Formula $R_{1}$
\end_inset

, so one of the 
\begin_inset Formula $O\left(n\left(d+1\right)\right)$
\end_inset

 arcs exiting 
\begin_inset Formula $R_{1}$
\end_inset

 must be changed.
 This will not happen a.a.s.
 unless 
\begin_inset Formula $m=\omega\left(d+1\right)/n$
\end_inset

.
\end_layout

\begin_layout Standard
We now prove 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:tournament"

\end_inset

.
 In accordance with the discussion in the introduction, we will work with
 the model where each edge is flipped with independent probability 
\begin_inset Formula $p$
\end_inset

, where 
\begin_inset Formula $2p{n \choose 2}=m$
\end_inset

.
 (Designating an edge for resampling with probability 
\begin_inset Formula $2p$
\end_inset

 is the same as flipping it with probability 
\begin_inset Formula $p$
\end_inset

).
\end_layout

\begin_layout Standard
Fix 
\begin_inset Formula $t$
\end_inset

; we will prove that 
\begin_inset Formula $P$
\end_inset

 is 
\begin_inset Formula $t$
\end_inset

-strongly connected.
 The idea of the proof is to choose a set 
\begin_inset Formula $S$
\end_inset

 of 
\begin_inset Formula $t$
\end_inset

 vertices with a large indegree and outdegree, then show that with high
 probability almost every vertex has many paths to and from each vertex
 in 
\begin_inset Formula $S$
\end_inset

.
 The probability that a vertex 
\begin_inset Formula $v$
\end_inset

 has paths from 
\begin_inset Formula $S$
\end_inset

 is smallest if 
\begin_inset Formula $v$
\end_inset

 has small indegree, so we need to show that not many vertices can have
 small indegree.
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:extreme-indegree-bound"

\end_inset

In any tournament, there are less than 
\begin_inset Formula $k$
\end_inset

 vertices with indegree (respectively outdegree) less than 
\begin_inset Formula $\left(k-1\right)/2$
\end_inset

.
\end_layout

\begin_layout Proof
The sum of indegrees (respectively outdegrees) of a tournament on 
\begin_inset Formula $k$
\end_inset

 vertices is 
\begin_inset Formula ${k \choose 2}$
\end_inset

, because each arc contributes 1 to this sum.
 Therefore in every set of 
\begin_inset Formula $k$
\end_inset

 vertices of a tournament, there is a vertex of outdegree (indegree) at
 least 
\begin_inset Formula $\left(k-1\right)/2$
\end_inset

 in the induced tournament.
\end_layout

\begin_layout Standard
A consequence of 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:extreme-indegree-bound"

\end_inset

 is that the set of all vertices with indegree (respectively outdegree)
 less than 
\begin_inset Formula $n/6$
\end_inset

 has size smaller than 
\begin_inset Formula $n/3$
\end_inset

.
 So, there are at least 
\begin_inset Formula $n/3$
\end_inset

 vertices with indegree and outdegree at least 
\begin_inset Formula $n/6$
\end_inset

.
 We can therefore choose a set 
\begin_inset Formula $S$
\end_inset

 of 
\begin_inset Formula $t$
\end_inset

 such vertices.
\end_layout

\begin_layout Standard
Now, we prove that the random perturbation does not change the in- and -out
 degrees very much.
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:preserve-degree"

\end_inset

If a vertex 
\begin_inset Formula $v$
\end_inset

 has outdegree (respectively indegree) 
\begin_inset Formula $k$
\end_inset

 in 
\begin_inset Formula $T$
\end_inset

, then it has outdegree (respectively indegree) at least 
\begin_inset Formula $k/3$
\end_inset

 in 
\begin_inset Formula $P$
\end_inset

, with probability 
\begin_inset Formula $e^{-\Omega\left(\sqrt{n}\right)}$
\end_inset

 uniformly over 
\begin_inset Formula $k$
\end_inset

.
\end_layout

\begin_layout Proof
We only prove the statement where 
\begin_inset Formula $v$
\end_inset

 has outdegree 
\begin_inset Formula $k$
\end_inset

; the indegree case is identical.
 If 
\begin_inset Formula $k=0$
\end_inset

 the lemma is trivial, so assume 
\begin_inset Formula $k\ge1$
\end_inset

.
 First consider the cases where 
\begin_inset Formula $k>\sqrt{n}$
\end_inset

 or 
\begin_inset Formula $p<1/\sqrt{n}$
\end_inset

.
 There are 
\begin_inset Formula $k$
\end_inset

 arcs pointing away from 
\begin_inset Formula $v$
\end_inset

 in 
\begin_inset Formula $T$
\end_inset

, and a Cherhoff bound says that the probability more than 
\begin_inset Formula $2k/3$
\end_inset

 arcs are changed by the perturbation is
\begin_inset Formula 
\[
e^{-\Omega\left(k^{2}/\E X\right)}=e^{-\Omega\left(\sqrt{n}\right)}.
\]

\end_inset

That is, with the required probability, 
\begin_inset Formula $k/3$
\end_inset

 of the original out-neighbours survive the perturbation.
\end_layout

\begin_layout Proof
Otherwise (for large 
\begin_inset Formula $n$
\end_inset

), there is a set of 
\begin_inset Formula $n/2$
\end_inset

 arcs pointing towards 
\begin_inset Formula $v$
\end_inset

 in 
\begin_inset Formula $T$
\end_inset

.
 A Chernoff bound says that the probability less than 
\begin_inset Formula $k/3$
\end_inset

 of these arcs are changed is 
\begin_inset Formula $e^{-\Omega\left(\sqrt{n}\right)}$
\end_inset

.
 That is, with the required probability, 
\begin_inset Formula $k/3$
\end_inset

 new out-neighbours are added by the perturbation.
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:path-from-home"

\end_inset

Suppose 
\begin_inset Formula $w$
\end_inset

 has outdegree (respectively indegree) at least 
\begin_inset Formula $n/6$
\end_inset

, and 
\begin_inset Formula $v\ne w$
\end_inset

 is a vertex with indegree (respectively outdegree) at least 
\begin_inset Formula $k$
\end_inset

.
 Then with probability 
\begin_inset Formula $1-e^{-\Omega\left(\sqrt{n}\right)}-e^{-\Omega\left(np\left(k+1\right)\right)}$
\end_inset

 (uniformly over 
\begin_inset Formula $k$
\end_inset

), there are 
\begin_inset Formula $t'=3t$
\end_inset

 internally vertex-disjoint paths of length at most 3 from 
\begin_inset Formula $w$
\end_inset

 to 
\begin_inset Formula $v$
\end_inset

 (respectively from 
\begin_inset Formula $v$
\end_inset

 to 
\begin_inset Formula $w$
\end_inset

).
\end_layout

\begin_layout Proof
We will only prove the statement where 
\begin_inset Formula $v$
\end_inset

 has indegree at least 
\begin_inset Formula $k$
\end_inset

; the outdegree case is identical.
 By independence, we can condition on the outcome of the perturbation on
 individual arcs.
 Condition on the outcome for all arcs adjacent to 
\begin_inset Formula $w$
\end_inset

, and let 
\begin_inset Formula $N_{P}^{+}\left(w\right)$
\end_inset

 be the set of vertices to which there is an arc from 
\begin_inset Formula $w$
\end_inset

 in 
\begin_inset Formula $P$
\end_inset

.
 By 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:preserve-degree"

\end_inset

, we can assume 
\begin_inset Formula $\left|N_{P}^{+}\left(w\right)\right|\ge n/18$
\end_inset

.
\end_layout

\begin_layout Proof
We first prove the lemma for the case where 
\begin_inset Formula $k\le12t'$
\end_inset

.
 There are at least 
\begin_inset Formula $n'=n/18-1$
\end_inset

 arcs between 
\begin_inset Formula $N_{P}^{+}\left(w\right)$
\end_inset

 and 
\begin_inset Formula $v$
\end_inset

, each of which will be pointing towards 
\begin_inset Formula $v$
\end_inset

 in 
\begin_inset Formula $P$
\end_inset

 with independent probability at least 
\begin_inset Formula $p$
\end_inset

.
 By a Chernoff bound, the probability less than 
\begin_inset Formula $t'$
\end_inset

 arcs will point from 
\begin_inset Formula $N_{P}^{+}\left(w\right)$
\end_inset

 to 
\begin_inset Formula $v$
\end_inset

 in 
\begin_inset Formula $P$
\end_inset

 is
\begin_inset Formula 
\[
e^{-\Omega\left(\E Z-t'\right)}=e^{-\Omega\left(np\right)}=e^{-\Omega\left(np\left(k+1\right)\right)}.
\]

\end_inset

So, with the required probability there are 
\begin_inset Formula $t'$
\end_inset

 suitable length-2 paths from 
\begin_inset Formula $w$
\end_inset

 to 
\begin_inset Formula $v$
\end_inset

.
\end_layout

\begin_layout Proof
We can now assume 
\begin_inset Formula $k>12t'$
\end_inset

.
 Condition on the result of the perturbation for the arcs adjacent to 
\begin_inset Formula $v$
\end_inset

 (in addition to the arcs we have conditioned on so far).
 Let 
\begin_inset Formula $N_{P}^{-}\left(v\right)$
\end_inset

 be the set of vertices from which there is an edge into 
\begin_inset Formula $v$
\end_inset

 in 
\begin_inset Formula $P$
\end_inset

; by 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:preserve-degree"

\end_inset

, we can assume 
\begin_inset Formula $\left|N_{P}^{-}\left(v\right)\right|\ge k/3$
\end_inset

.
\end_layout

\begin_layout Proof
Now, if 
\begin_inset Formula $\left|N_{P}^{+}\left(w\right)\cap N_{P}^{-}\left(v\right)\right|\ge t'$
\end_inset

 then there are 
\begin_inset Formula $t'$
\end_inset

 disjoint length-2 paths from 
\begin_inset Formula $w$
\end_inset

 to 
\begin_inset Formula $v$
\end_inset

 and we are done.
 So we can assume 
\begin_inset Formula $U^{+}=N_{P}^{+}\left(w\right)\backslash\left(N_{P}^{-}\left(v\right)\cup\left\{ v\right\} \right)$
\end_inset

 has at least 
\begin_inset Formula $n'=n/18-t'-1$
\end_inset

 vertices, and 
\begin_inset Formula $U^{-}=N_{P}^{-}\left(v\right)\backslash\left(N_{P}^{+}\left(w\right)\cup\left\{ w\right\} \right)$
\end_inset

 has at least 
\begin_inset Formula $k'=k/6-t'-1$
\end_inset

 vertices (note 
\begin_inset Formula $k'\ge t'$
\end_inset

 by assumption).
\end_layout

\begin_layout Proof
Now, we would like to show that with the required probability there is a
 set of 
\begin_inset Formula $t'$
\end_inset

 independent arcs from 
\begin_inset Formula $U^{+}$
\end_inset

 into 
\begin_inset Formula $U^{-}$
\end_inset

 in 
\begin_inset Formula $P$
\end_inset

, which will give 
\begin_inset Formula $t'$
\end_inset

 suitable length-3 paths.
 Partition 
\begin_inset Formula $U^{+}$
\end_inset

(respectively 
\begin_inset Formula $U^{-}$
\end_inset

) into subsets 
\begin_inset Formula $U_{1}^{+},\dots,U_{t'}^{+}$
\end_inset

 (respectively 
\begin_inset Formula $U_{1}^{-},\dots,U_{t'}^{-}$
\end_inset

), such that each 
\begin_inset Formula $\left|U_{1}^{+}\right|>n'/\left(2t'\right)$
\end_inset

 and each 
\begin_inset Formula $\left|U_{1}^{-}\right|>k'/\left(2t'\right)$
\end_inset

.
 For each 
\begin_inset Formula $i$
\end_inset

, the probability that there is no arc from 
\begin_inset Formula $U_{i}^{+}$
\end_inset

 into 
\begin_inset Formula $U_{i}^{-}$
\end_inset

 after the perturbation is at most
\begin_inset Formula 
\[
\left(1-p/2\right)^{n'k'/\left(4t'\right)}\le e^{-\Theta\left(np\left(k+1\right)\right)},
\]

\end_inset

so with the required probability there a set of 
\begin_inset Formula $t'$
\end_inset

 suitable independent arcs, each between a pair 
\begin_inset Formula $U_{i}^{+},U_{i}^{-}$
\end_inset

.
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:lots-of-paths"

\end_inset

Fix some 
\begin_inset Formula $w\in S$
\end_inset

.
 In 
\begin_inset Formula $P$
\end_inset

, there are a.a.s.
 
\begin_inset Formula $t$
\end_inset

 disjoint paths from 
\begin_inset Formula $w$
\end_inset

 to each other vertex (respectively, from each other vertex to 
\begin_inset Formula $w$
\end_inset

).
\end_layout

\begin_layout Proof
We only prove there are paths from 
\begin_inset Formula $w$
\end_inset

 to each other vertex; the reverse case is identical.
 If there are 
\begin_inset Formula $3t$
\end_inset

 disjoint paths of length at most 3 from 
\begin_inset Formula $w$
\end_inset

 to 
\begin_inset Formula $v$
\end_inset

 then we say 
\begin_inset Formula $v$
\end_inset

 is 
\emph on
safe
\emph default
.
 It follows from 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:path-from-home"

\end_inset

 that a vertex with indegree 
\begin_inset Formula $k$
\end_inset

 is safe with probability 
\begin_inset Formula $1-e^{-\Omega\left(\sqrt{n}\right)}-e^{-\Omega\left(np\left(k+1\right)\right)}$
\end_inset

.
\end_layout

\begin_layout Proof
By 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:extreme-indegree-bound"

\end_inset

, there are at most 
\begin_inset Formula $\left(2d+1\right)$
\end_inset

 vertices with outdegree 
\begin_inset Formula $d$
\end_inset

, and the vertex with the 
\begin_inset Formula $2k$
\end_inset

th smallest outdegree has outdegree at least 
\begin_inset Formula $k-1$
\end_inset

.
 Let 
\begin_inset Formula $Q$
\end_inset

 be the set of non-safe vertices, and note
\begin_inset Formula 
\begin{align*}
\E\left|Q\right| & =\left(2d+1\right)e^{-\Omega\left(np\left(d+1\right)\right)}+\sum_{k=d+1}^{n}2e^{-\Omega\left(np\left(k+1\right)\right)}+ne^{-\Omega\left(\sqrt{n}\right)}\\
 & =e^{-\Omega\left(np\left(d+1\right)\right)}\left(O\left(d+1\right)+\frac{1}{1-e^{-\Omega\left(np\right)}}\right)+o\left(1\right)\\
 & =e^{-\Omega\left(np\left(d+1\right)\right)}O\left(d+1\right).
\end{align*}

\end_inset

where we have used the geometric series formula, the inequality 
\begin_inset Formula $1-e^{-x}\ge\left(x\land1\right)/2$
\end_inset

 (for positive 
\begin_inset Formula $x$
\end_inset

) and the fact that 
\begin_inset Formula $d+1=\Omega\left(1\right)$
\end_inset

.
\end_layout

\begin_layout Proof
By Markov's inequality, a.a.s.
 
\begin_inset Formula $\left|Q\right|\le\sqrt{e^{-\Omega\left(pn\left(d+1\right)\right)}}O\left(d+1\right)=o\left(d+1\right)$
\end_inset

.
 If 
\begin_inset Formula $d\le4t$
\end_inset

 then 
\begin_inset Formula $\left|Q\right|=0$
\end_inset

 for large 
\begin_inset Formula $n$
\end_inset

.
 Otherwise, for large 
\begin_inset Formula $n$
\end_inset

, 
\begin_inset Formula $\left|Q\right|\le3d$
\end_inset

, so every vertex 
\begin_inset Formula $v\in Q$
\end_inset

 has 
\begin_inset Formula $3t$
\end_inset

 safe neighbours 
\begin_inset Formula $v_{1},\dots,v_{3t}$
\end_inset

.
 Now, fix a maximal set 
\begin_inset Formula $M$
\end_inset

 of disjoint paths from 
\begin_inset Formula $w$
\end_inset

 to 
\begin_inset Formula $v$
\end_inset

.
 If 
\begin_inset Formula $\left|M\right|<t$
\end_inset

 then the paths in 
\begin_inset Formula $M$
\end_inset

 collectively use less than 
\begin_inset Formula $3t$
\end_inset

 vertices other than 
\begin_inset Formula $t$
\end_inset

, so there is some 
\begin_inset Formula $v_{i}$
\end_inset

 not in any path of 
\begin_inset Formula $M$
\end_inset

, and there is some path from 
\begin_inset Formula $w$
\end_inset

 to 
\begin_inset Formula $v_{i}$
\end_inset

 that does not contain any vertex of 
\begin_inset Formula $M$
\end_inset

.
 But then 
\begin_inset Formula $w\dots v_{i}v$
\end_inset

 is a path from 
\begin_inset Formula $w$
\end_inset

 to 
\begin_inset Formula $v$
\end_inset

 disjoint with every path in 
\begin_inset Formula $M$
\end_inset

, contradicting maximality.
\end_layout

\begin_layout Standard
It follows from 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:lots-of-paths"

\end_inset

 that a.a.s.
 every vertex outside 
\begin_inset Formula $S$
\end_inset

 has 
\begin_inset Formula $t$
\end_inset

 disjoint paths to and from every vertex in 
\begin_inset Formula $S$
\end_inset

.
 If we delete 
\begin_inset Formula $t-1$
\end_inset

 vertices, then there is at least one vertex 
\begin_inset Formula $w$
\end_inset

 of 
\begin_inset Formula $S$
\end_inset

 remaining, and 
\begin_inset Formula $w$
\end_inset

 has least one path to and from every other vertex.
 That is, 
\begin_inset Formula $P$
\end_inset

 is strongly connected.
 (In fact, we have also proved that 
\begin_inset Formula $P$
\end_inset

 has diameter at most 8).
\end_layout

\begin_layout Section
Concluding Remarks
\end_layout

\begin_layout Standard
We have determined the amount of random perturbation required to make a
 tournament, dense digraph or uniform hypergraph Hamiltonian.
 In the process, we have proved a general lemma about pancyclicity in highly
 connected digraphs, and demonstrated an interesting application of the
 Szemer
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
'
\end_layout

\end_inset

edi regularity lemma.
 There are a few important questions this paper leaves open.
\end_layout

\begin_layout Standard
First, we have only studied loose Hamiltonicity.
 The other most popular notion of a hypergraph cycle is a 
\emph on
tight
\emph default
 cycle, in which every consecutive pair of edges in the cycle intersects
 in 
\begin_inset Formula $k-1$
\end_inset

 vertices.
 More generally, an 
\begin_inset Formula $\ell$
\end_inset

-cycle has consecutive edges intersecting in 
\begin_inset Formula $k-\ell$
\end_inset

 vertices.
 Also, we have only studied hypergraphs with high 
\begin_inset Formula $\left(k-1\right)$
\end_inset

-degree, which is the strongest density assumption we could make.
 There are a large variety of Dirac-type theorems for different types of
 minimum degree and different types of cycles (see 
\begin_inset CommandInset citation
LatexCommand cite
key "RR10"

\end_inset

 for a survey), which would suggest that similar random perturbation results
 are possible in these settings.
 In addition, it is possible that our use of Szemer
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
'e
\end_layout

\end_inset

di's regularity lemma could be avoided, thereby drastically improving the
 constants 
\begin_inset Formula $\chypham\left(\alpha\right)$
\end_inset

 and 
\begin_inset Formula $\chypmat\left(\alpha\right)$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "references"
options "amsplain"

\end_inset


\end_layout

\end_body
\end_document
