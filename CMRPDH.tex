\documentclass[11pt,english]{article}
\renewcommand{\rmdefault}{cmr}
\renewcommand{\sfdefault}{cmss}
\renewcommand{\ttdefault}{cmtt}
\usepackage[T1]{fontenc}
\usepackage[latin9]{inputenc}
\usepackage{geometry}
\geometry{verbose,tmargin=2.5cm,bmargin=2.5cm,lmargin=2.5cm,rmargin=2.5cm}
\setlength{\parskip}{\bigskipamount}
\setlength{\parindent}{0pt}
\usepackage{babel}
\usepackage{float}
\usepackage{amsthm}
\usepackage{amsmath}
\usepackage{amssymb}
%\usepackage{setspace}
\usepackage{esint}
%\setstretch{0.98}
\usepackage[unicode=true,pdfusetitle,
 bookmarks=true,bookmarksnumbered=false,bookmarksopen=false,
 breaklinks=false,pdfborder={0 0 0},backref=false,colorlinks=false]
 {hyperref}

% cleveref allows \ref{thm:asdf} instead of Theorem~\ref{thm:asdf}
\usepackage[nameinlink,capitalise,noabbrev]{cleveref}
\AtBeginDocument{\renewcommand{\ref}[1]{\cref{#1}}}

\theoremstyle{plain}
\newtheorem{thm}{\protect\theoremname}
\crefname{thm}{Theorem}{Theorems}
\theoremstyle{definition}
\newtheorem{defn}[thm]{\protect\definitionname}
\theoremstyle{definition}
\newtheorem{example}[thm]{\protect\examplename}
\theoremstyle{plain}
\newtheorem{prop}[thm]{\protect\propositionname}
\theoremstyle{plain}
\newtheorem{cor}[thm]{\protect\corollaryname}
\theoremstyle{plain}
\newtheorem{lem}[thm]{\protect\lemmaname}
\crefname{lem}{Lemma}{Lemmas}
\theoremstyle{plain}
\newtheorem{conjecture}[thm]{\protect\conjecturename}
\theoremstyle{remark}
\newtheorem{rem}[thm]{\protect\remarkname}
\theoremstyle{remark}
\newtheorem{claim}[thm]{\protect\claimname}

% equation cref format
\crefformat{equation}{#2(#1)#3}

% \left(\right) should behave the same as ()
\let\originalleft\left
\let\originalright\right
\renewcommand{\left}{\mathopen{}\mathclose\bgroup\originalleft}
\renewcommand{\right}{\aftergroup\egroup\originalright}
\usepackage{pgfplots}
\usetikzlibrary{pgfplots.groupplots}
\usepackage{verbatim}

%make sure tildes in url are vertically centered
\makeatletter
\renewcommand*{\UrlTildeSpecial}{%
  \do\~{%
    \mbox{%
      \fontfamily{ptm}\selectfont
      \textasciitilde
    }%
  }%
}%
\let\Url@force@Tilde\UrlTildeSpecial
\makeatother

%graph drawing
\usepackage{tikz}
\usetikzlibrary{external}
\usetikzlibrary{decorations.markings}
%\usetikzlibrary{arrows.meta}
\tikzexternalize
\tikzstyle{vertex}=[circle,draw=black,fill=black,inner sep=0,minimum size=0.2cm,text=white,font=\footnotesize]
\tikzset{arc/.style={
        decoration={markings,
            mark= at position 0.5 with {\arrow{Latex[length=2mm,width=2mm]}} ,
        },
        postaction={decorate}
    }
}
\tikzset{every loop/.style={min distance=50,in=50,out=130,looseness=7}}

%caption labels
\usepackage[labelfont=bf,labelsep=period]{caption}

\usepackage{enumitem}

\makeatother

  \providecommand{\claimname}{Claim}
  \providecommand{\conjecturename}{Conjecture}
  \providecommand{\corollaryname}{Corollary}
  \providecommand{\definitionname}{Definition}
  \providecommand{\examplename}{Example}
  \providecommand{\lemmaname}{Lemma}
  \providecommand{\propositionname}{Proposition}
  \providecommand{\remarkname}{Remark}
\providecommand{\theoremname}{Theorem}

\begin{document}

\title{Cycles and matchings in randomly perturbed digraphs and hypergraphs}


\author{Michael Krivelevich
\thanks{School of Mathematical Sciences, Raymond and Beverly Sackler Faculty of Exact Sciences, Tel Aviv University, 6997801, Israel. Email: \href{mailto:krivelev@post.tau.ac.il}
{\nolinkurl{krivelev@post.tau.ac.il}}. Research supported in part by USA-Israel BSF Grant 2010115 and
by grant 912/12 from the Israel Science Foundation.}\and
Matthew Kwan\thanks{Department of Mathematics, ETH, 8092 Zurich. Email: \href{mailto:matthew.kwan@math.ethz.ch}
{\nolinkurl{matthew.kwan@math.ethz.ch}}}\and
Benny Sudakov\thanks{Department of Mathematics, ETH, 8092 Zurich. Email: \href{mailto:benjamin.sudakov@math.ethz.ch}{\nolinkurl{benjamin.sudakov@math.ethz.ch}}. Research supported in part by SNSF grant 200021-149111 and by a USA-Israel BSF grant.}}

\maketitle
\global\long\def\RR{\mathbb{R}}
\global\long\def\QQ{\mathbb{Q}}
\global\long\def\HH{\mathbb{H}}
\global\long\def\E{\mathbb{E}}
\global\long\def\Var{\operatorname{Var}}
\global\long\def\CC{\mathbb{C}}
\global\long\def\NN{\mathbb{N}}
\global\long\def\ZZ{\mathbb{Z}}
\global\long\def\GG{\mathbb{G}}
\global\long\def\BB{\mathbb{B}}
\global\long\def\DD{\mathbb{D}}
\global\long\def\cL{\mathcal{L}}
\global\long\def\supp{\operatorname{supp}}
\global\long\def\one{\boldsymbol{1}}
\global\long\def\range#1{\left[#1\right]}
\global\long\def\d{\operatorname{d}}
\global\long\def\falling#1#2{\left(#1\right)_{#2}}
\global\long\def\f{\mathbf{f}}
\global\long\def\im{\operatorname{im}}
\global\long\def\sp{\operatorname{span}}
\global\long\def\sign{\operatorname{sign}}
\global\long\def\mod{\operatorname{mod}}
\global\long\def\id{\operatorname{id}}
\global\long\def\disc{\operatorname{disc}}
\global\long\def\lindisc{\operatorname{lindisc}}
\global\long\def\tr{\operatorname{tr}}
\global\long\def\adj{\operatorname{adj}}
\global\long\def\Unif{\operatorname{Unif}}
\global\long\def\Po{\operatorname{Po}}
\global\long\def\Bin{\operatorname{Bin}}
\global\long\def\Ber{\operatorname{Ber}}
\global\long\def\Geom{\operatorname{Geom}}
\global\long\def\Hom{\operatorname{Hom}}
\global\long\def\floor#1{\left\lfloor #1\right\rfloor }
\global\long\def\ceil#1{\left\lceil #1\right\rceil }
\global\long\def\T{\mathbf{T}}
\global\long\def\N{\mathbf{N}}
\global\long\def\B{\mathbf{B}}
\global\long\def\a{\boldsymbol{\alpha}}
\global\long\def\b{\boldsymbol{\beta}}
\global\long\def\x{\mathbf{x}}
\global\long\def\y{\mathbf{y}}
\global\long\def\o{\boldsymbol{\omega}}
\global\long\def\cdi{c}
\global\long\def\chypham{c_{k}^{\mathrm{H}}}
\global\long\def\chypmat{c_{k}^{\mathrm{M}}}
\global\long\def\cto{c^{\mathrm{T}}}
\global\long\def\a{\beta}
%\global\long\def\amat{\beta^{\mathrm{M}}}
\global\long\def\amat{\a}
%\global\long\def\aham{\beta^{\mathrm{H}}}
\global\long\def\aham{\a}

\begin{abstract}
We give several results showing that different discrete structures
gain certain spanning structures (in particular, Hamilton cycles) after a modest random perturbation. First, we show
that adding linearly many random edges to a dense $k$-uniform hypergraph ensures
the (asymptotically almost sure) existence of a perfect matching or a loose
Hamilton cycle. This involves a nonstandard application of Szemer\'edi's
Regularity Lemma. We next show that digraphs with certain strong expansion
properties are pancyclic, and use this to show that adding a linear
number of random edges typically makes a dense digraph pancyclic. Finally, we
show that perturbing a certain (minimum-degree-dependent) number of
random edges in a tournament typically ensures the existence of multiple edge-disjoint
Hamilton cycles. All our results are tight.
\end{abstract}

\section{Introduction and Results}

We say that a graph is \emph{Hamiltonian} if it has a \emph{Hamilton
cycle}: a simple cycle containing every vertex in the graph. Hamiltonicity
is a central notion in graph theory and has been extensively studied
in a wide range of contexts. In particular, due to a seminal paper
by Karp \cite{Kar72}, it has become a canonical NP-complete problem
to determine whether an arbitrary graph is Hamiltonian. There are
nevertheless a variety of easily-checkable conditions that guarantee
Hamiltonicity. The most famous of these is given by a classical theorem
of Dirac \cite{Dir52}, which states that any $n$-vertex graph ($n\ge 3$) with
minimum degree at least $n/2$ is Hamiltonian.

Dirac's theorem requires a very strong density condition, but in a
certain asymptotic sense ``almost all'' dense graphs are Hamiltonian.
If we fix $\alpha>0$ and select a graph uniformly at random among
the (labelled) graphs with $n$ vertices and $\alpha{n \choose 2}$
edges, then the degrees will probably each be about $\alpha n$. Such
a random graph is Hamiltonian with probability $1-o\left(1\right)$
(we say it is Hamiltonian \emph{asymptotically almost surely}, or
\emph{a.a.s.}). This follows from a stronger result \cite{Pos76}
that gives a \emph{threshold} for Hamiltonicity: a random $n$-vertex,
$m$-edge graph is Hamiltonian a.a.s. if $m\gg n\log n$, and fails
to be Hamiltonian a.a.s. if $m\ll n\log n$. Here and from now on,
all asymptotics are as $n\to\infty$, and we implicitly round large
quantities to integers.

In \cite{BFM03}, the authors studied the random graph model that
starts with a dense graph and adds $m$ random edges (this model has
since been studied in a number of other contexts; see for example
\cite{BHM04,KST06}). They found that to ensure Hamiltonicity in this
model we only need $m$ to be linear, saving a logarithmic factor
over the standard model where we start with nothing. To be precise,
\cite[Theorem~1]{BFM03} says that for every $\alpha>0$ there is
$\cdi\left(\alpha\right)$ such that if we start with a graph with
minimum degree at least $\alpha n$ and add $\cdi\left(\alpha\right)n$
random edges, then the resulting graph will a.a.s. be Hamiltonian.
Note that some dense graphs require a linear number of extra edges
to become Hamiltonian (consider the complete bipartite graph with
partition sizes $n/3$ and $2n/3$), so the order of magnitude of this result is tight. We can interpret this theorem as quantifying the ``fragility''
of the few dense graphs that are not Hamiltonian, by determining the
amount of random perturbation that is necessary to make a dense graph
Hamiltonian. A comparison can be drawn to the notion of \emph{smoothed
analysis} of algorithms introduced in \cite{ST04}, which involves
studying the performance of algorithms on randomly perturbed inputs.

Our first contribution in this paper is to generalize the aforementioned
theorem to hypergraphs (and to give a corresponding result for perfect
matchings, which is nontrivial in the hypergraph setting). Unfortunately,
there is no single most natural notion of a cycle or of minimum degree
in hypergraphs. A $k$-uniform \emph{loose} cycle is a $k$-uniform
hypergraph with a cyclic ordering on its vertices such that every
edge consists of $k$ consecutive vertices and every pair of consecutive
edges intersects in exactly one vertex. The degree of a set of vertices
is the number of edges that include that set, and the \emph{minimum
$\left(k-1\right)$-degree }$\delta_{k-1}$ is the minimum degree
among sets of $k-1$ vertices.
\begin{thm}
\label{thm:hypergraph-theorems}Let $\HH_{k}\left(n,m\right)$ be
the uniform distribution on $m$-edge $k$-uniform hypergraphs on
the vertex set $\range n$.

\begin{enumerate}[topsep=0px,label=(\alph*)]

\item{There is $\chypmat\left(\alpha\right)$ such that if $H$ is
a $k$-uniform hypergraph on $\left[kn\right]$ with $\delta_{k-1}\left(H\right)\ge\alpha n$,
and $R\in\HH_{k}\left(kn,\chypmat\left(\alpha\right)n\right)$, then
$H\cup R$ a.a.s. has a perfect matching.}

\item{There is $\chypham\left(\alpha\right)$ such that if $H$ is
a $k$-uniform hypergraph on $\left[\left(k-1\right)n\right]$with
$\delta_{k-1}\left(H\right)\ge\alpha n$, and $R\in\HH\left(\left(k-1\right)n,\chypham\left(\alpha\right)n\right)$,
then $H\cup R$ a.a.s. has a loose Hamilton cycle.}

\end{enumerate}
\end{thm}
All the motivation for graphs is still relevant in the hypergraph setting. Dirac's theorem approximately generalizes to hypergraphs (see \cite{KKMO11}): for small $\varepsilon$ and large $n$, if the minimum $\left(k-1\right)$-degree of an $n$-vertex $k$-uniform hypergraph is greater than $\left(1/\left(2\left(k-1\right)\right)+\varepsilon\right)\,n$ then that hypergraph contains a loose Hamilton cycle. Just as for graphs, the threshold for both perfect matchings and loose Hamilton cycles in $k$-uniform hypergraphs is $n\log n$ random
edges (see \cite{DF11} and \cite[Corollary~2.6]{JKV08}), so ``almost
all'' dense hypergraphs have Hamilton cycles and perfect matchings.

We will prove \ref{thm:hypergraph-theorems}, and show that it is
tight, in \ref{sec:hypergraphs}. The methods usually employed to
study Hamilton cycles and perfect matchings in random graphs are largely
ineffective in the hypergraph setting, so we need a very different
proof. In particular, we cannot easily manipulate paths for P\'osa-type
arguments, and we do not have an analogue of Hall's marriage theorem
allowing us to deduce the existence of a perfect matching from an
expansion property. Our proof involves reducing the theorem to the
existence of a perfect matching in a certain randomly perturbed bipartite
graph. The ``reason'' for a perfect matching in this perturbed graph
seems to be quite different depending on the structure of the initial
bipartite graph, so we make critical use of the structural description
given by Szemer\'edi's regularity lemma.

Our second contribution in this paper is a theorem giving a general
expansion condition for\emph{ pancyclicity}. We say an $n$-vertex
\mbox{(di-)}graph is pancyclic if it contains cycles of all lengths
ranging from 3 to $n$.
\begin{thm}
\label{lem:pseudorandom-pancyclic}Let $D$ be a directed graph on
$n$ vertices with all in- and out- degrees at least $8k$, and suppose
for all disjoint $A,B\subseteq V\left(D\right)$ with $\left|A\right|=\left|B\right|\ge k$,
there is an arc from $A$ to $B$. Then $D$ is pancyclic.
\end{thm}
We hope this theorem could be of independent interest, but our particular
motivation is that it implies a number of results about randomly perturbed
graphs and digraphs. In particular it provides very simple proofs
of the theorems in \cite{BFM03} concerning Hamiltonicity in randomly
perturbed graphs and digraphs, and allows us to extend these theorems
to pancyclicity. We will prove \ref{lem:pseudorandom-pancyclic} and
its corollaries in \ref{sec:digraphs}.

Our final theorem concerns randomly perturbed tournaments. The model
that starts with a fixed \mbox{(di-/hyper-)}graph and adds random
edges is not suitable for studying random perturbation in tournaments,
because we want our perturbed tournament to remain a tournament. There
are several other models of random perturbation we could consider
that do allow us to make sense of randomly perturbed tournaments,
or are more natural in certain contexts. However, the types of results
in this paper are not sensitive to the model used. We will briefly
describe a few different models here.

First, note that for most practical purposes, models that involve
the selection of $m$ random edges are equivalent to models that involve
the selection of each edge with independent probability $p$, where
$m=p{n \choose 2}$. One perspective or the other can be more intuitive
or result in cleaner proofs; we will use both interchangeably as is
convenient without further discussion. In all the situations in this
paper, equivalence can be proved with standard conditioning and coupling
arguments.

As suggested in \cite[Definition~1]{ST03}, one possible alternative
model is to \emph{change} random edges, instead of adding them. So,
for our results so far, instead of taking the union of a fixed dense
object with a random sparse object, we would take the symmetric difference.
Our results still hold in this alternative model, basically because
we can break up such a random perturbation into a phase that deletes
edges (this does not destroy denseness), and a phase that adds edges.
One undesirable quirk of this model is that it is not ``monotonic'':
if we change too many edges then we ``lose our randomness'' and
end up at the complement of our original object, which might not be
Hamiltonian.

A second alternative model is to start with our fixed object and ``make
it more random'' by interpolating slightly towards the corresponding
uniform distribution. For example, in the graph case we could randomly
designate a small number of pairs of vertices for ``resampling''
and then decide whether the corresponding edges should be present
uniformly and independently at random. This is mostly equivalent to
the symmetric difference model, and is the model in which we prefer
to state our theorem about randomly perturbed tournaments.

It is known that almost all tournaments have a Hamiltonian cycle (see
\ref{sec:tournaments}), so we do not need to restrict our attention
to ``dense'' tournaments. Nevertheless, we can give stronger results
for tournaments with large minimum in- and out- degrees. We are also
able to show that randomly perturbed tournaments are not just Hamiltonian,
but have multiple edge-disjoint Hamilton cycles.
\begin{thm}
\label{thm:tournament}Consider a tournament $T$ with $n$ vertices
and all in- and out- degrees at least $d$. Independently designate
$m=\omega\left(d+1\right)/n$ edges as ``random'' then choose the
orientations of the chosen edges independently and uniformly at random.
The resulting perturbed tournament $P$ a.a.s. has $q$ arc-disjoint
Hamilton cycles, for $q=O\left(1\right)$.
\end{thm}
We will prove \ref{thm:tournament} and show that it is tight in \ref{sec:tournaments}.


\section{\label{sec:hypergraphs}Perfect Matchings and Hamilton Cycles in
Hypergraphs}

We first make some observations about our minimum degree requirement.
The \emph{minimum $q$-degree} $\delta_{q}\left(H\right)$ of $H$
is the minimum degree among all sets of $q$ vertices. Note that this
generalizes the two notions of denseness for graphs: in some contexts,
we say graphs are dense if they have many edges (large $\delta_{0}$),
whereas in this paper we need a stronger notion of graph denseness
based on minimum degree ($\delta_{1}$). For a $k$-regular hypergraph
$H$, a double-counting argument shows that if $q\le p$ then
\[
\delta_{q}\left(H\right)\ge\delta_{p}\left(H\right){n-q \choose p-q}\left.\vphantom{\sum}\right/{k-q \choose p-q}.
\]
So, imposing that a $k$-uniform hypergraph has large $\left(k-1\right)$-degree
ensures that it has large $q$-degrees for all $q$. In particular,
our requirement $\delta_{k-1}\left(H\right)=\Omega\left(n\right)$
actually implies $\delta_{q}\left(H\right)=\Omega\left(n^{k-q}\right)$
for all $q$.

Next, note that \ref{thm:hypergraph-theorems} is tight for essentially
the same reason as its corresponding theorem for graphs. Consider the dense ``complete
bipartite hypergraph'' which has two parts of sizes $n$ and
$2kn$, and has all possible $k$-edges that contain at least one
vertex from each part. Only $2n$ of these edges can contribute
to a loose Hamilton cycle, so a linear number must be added to complete
the necessary $\left(2k+1\right)n/\left(k-1\right)$ edges. Similarly, this graph contains only $n$ out ouf the $\left(2k+1\right)n/k$ required edges in a perfect matching.

Now we proceed to the proof of \ref{thm:hypergraph-theorems}, which
will follow from a sequence of lemmas. The first step is to show that
$R$ almost gives the structure of interest on its own. Let a\emph{
sub-cycle} be a hypergraph which can be extended to a loose Hamilton
cycle by adding edges.
\begin{lem}
\label{lem:hypergraph-almost-object}For any $\varepsilon>0$:

\begin{enumerate}[topsep=0px,label=(\alph*)]

\item{There is $b_{k}^{\mathrm{M}}\left(\varepsilon\right)$ such
that $R\in\HH_{k}\left(kn,b_{k}^{\mathrm{M}}\left(\varepsilon\right)n\right)$
a.a.s. has a matching of size $\left(1-\varepsilon\right)n$.}

\item{For any $\varepsilon>0$, there is $b_{k}^{\mathrm{H}}\left(\varepsilon\right)$
such that $R\in\HH_{k}\left(\left(k-1\right)n,b_{k}^{\mathrm{H}}\left(\varepsilon\right)n\right)$
a.a.s. has a sub-cycle of size $\left(1-\varepsilon\right)n$.}

\end{enumerate}\end{lem}
\begin{proof}
[Proof of \ref{lem:hypergraph-almost-object}(a)]To realize the distribution
$\HH_{k}\left(kn,\beta_{k}'\left(\varepsilon\right)n\right)$, imagine
that independently uniformly random edges are repeatedly dropping
into $R$, until we have seen $b_{k}^{\mathrm{M}}\left(\varepsilon\right)$
distinct edges. We iteratively build a matching $M$ greedily. If
a new edge $e$ drops into $R$ which does not share any vertices
with the edges in $M$ so far, then add $e$ to $M$. If we have already
added $i$ edges to $M$, then the probability we will add the next
random edge is
\[
p_{i}={kn-ki \choose k}\left.\vphantom{\sum}\right/{kn \choose k}=\Omega\left(\left(\frac{n-i}{n}\right)^{k}\right).
\]
The number of random edges required to build a matching of size $\left(1-\varepsilon\right)n$
therefore has the distribution of
\[
X=\sum_{i=1}^{\left(1-\varepsilon\right)n}X_{i},
\]
where each $X_{i}$ is independently geometrically distributed with
success probability $p_{i}$. By Chebyshev's inequality or a Chernoff
bound, $X$ is a.a.s. close to its expectation, which is at most
\[
O\left(\sum_{i=1}^{\left(1-\varepsilon\right)n}n^{k}/\left(n-i\right)^{k}\right)=O\left(n^{k}\int_{\varepsilon n}^{\infty}\frac{1}{x^{k}}dx\right)=O\left(n\right).
\]
So, if $b_{k}^{\mathrm{M}}\left(\varepsilon\right)$ is large enough
then a.a.s. $\left|M\right|\ge\left(1-\varepsilon\right)n$.
\end{proof}

\begin{proof}
[Proof of \ref{lem:hypergraph-almost-object}(b)]A sub-cycle is a
loose Hamilton cycle or a disjoint union of ``loose paths'', but
a union of disjoint paths may not be a sub-cycle if it has so many
paths that there are not enough vertices left to link them together.
A union of $j$ paths (which have length greater than zero) with a
total of $i$ edges is a sub-cycle precisely when $i+j\le n$. Call
such sub-cycles \emph{proper }sub-cycles.

As in the proof of \ref{lem:hypergraph-almost-object}, imagine that
independently uniformly random edges are repeatedly dropping into
$R$. We build a proper sub-cycle $S$ greedily. Suppose we are at
a point where $S$ has $i$ edges and $j$ paths, with $i\le\left(1-\varepsilon\right)n$.
There are $\left(k-1\right)i+j\le\left(k-2\right)i+n$ vertices in
the paths in $S$.

There are 3 kinds of edges we can add to $S$: an edge that starts
a new loose path (``type 1''), an edge that extends an existing
path (``type 2''), or an edge that joins two paths together (``type
3''). We can only add a type 1 edge when $i+j\le n-2$, and can only
add a type 2 edge when $i+j\le n-1$.

If $i+j\le n-2$ then there are at least
\[
{\left(k-1\right)n-\left(\left(k-2\right)i+n\right) \choose k}={\left(k-2\right)\left(n-i\right) \choose k}=\Omega\left(\left(n-i\right)^{k}\right)
\]
type-1 edges that could possibly be added. Otherwise, we must have
$j>n-2-i\ge\varepsilon n-2$, so (identifying one vertex in an extremal
edge of each path as ``eligible to be joined''), there are at least
\[
{j \choose 2}{\left(k-2\right)\left(n-i\right) \choose k-2}=\Omega\left(n^{2}\left(n-i\right)^{k-2}\right)=\Omega\left(\left(n-i\right)^{k}\right)
\]
type-3 edges that could be added. Combining both cases, we can see
that if $S$ has $i\le\left(1-\varepsilon\right)n$ edges, then the
next edge will be added with probability at least
\[
\Omega\left(\left(n-i\right)^{k}\right)\left.\vphantom{\sum}\right/{\left(k-1\right)n \choose k}=\Omega\left(\left(\frac{n-i}{n}\right)^{k}\right).
\]
We conclude with the same reasoning as the proof of \ref{lem:hypergraph-almost-object}(a).
\end{proof}
The second step to prove \ref{thm:hypergraph-theorems} is to show that a dense
hypergraph plus a large partial structure a.a.s. gives the structure
we are looking for. For both theorems, we will be able to reduce this
step to the following lemma.
\begin{lem}
\label{lem:bipartite-plus-big-matching-perfect}There is $\xi\left(\alpha\right)>0$ 
such that the following holds. Let $G$ be a bipartite graph with
parts $A,B$ of equal size $n$, and suppose $\delta\left(G\right)\ge\alpha n$.
Let $M$ be a uniformly random matching with $\left(1-\xi\left(\alpha\right)\right)n$
edges between $A$ and $B$. Then a.a.s. $G\cup M$ has a perfect matching.
\end{lem}
The immediate na\"ive approach to prove this lemma would be to show each set of vertices expands, and then to apply the union bound and Hall's marriage theorem. However, the
probability of failure to expand is not small enough for this to work.
We can gain some insight into the problem by considering two ``extremal''
cases for $G$. First, consider the case where the edges of $G$ are
not evenly-distributed, and are ``concentrated'' in certain spots.
For example, identify sets $A'\subset A$ and $B'\subset B$ with
$\left|A'\right|,\left|B'\right|=\alpha n$, and let $G$ contain
only those edges incident to a vertex in $A'$ or $B'$. The addition
of the near-perfect matching $M$ gives a near-perfect matching between
$A\backslash A'$ and $B\backslash B'$, and we can match the unmatched
vertices from $A$ (respectively $B$) with any element of $B'$ (respectively
$A'$). That is, if our graph is not well-distributed, then the more
concentrated parts help us to augment $M$ into a perfect matching in
$G\cup M$. On the other extreme, if $G$ is a random-like, well-distributed
dense graph then we cannot augment $M$ in the same way. But this
is not necessary, because a random dense graph $G$ contains a perfect
matching on its own! In order to apply these ideas to prove the lemma
for an arbitrary graph $G$, we use the structural description of
$G$ provided by Szemer\'edi's regularity lemma.

For a disjoint pair of vertex sets $\left(X,Y\right)$ in a graph,
let its \emph{density} $d\left(X,Y\right)$ be the number of edges
between $X$ and $Y$, divided by $\left|X\right|\left|Y\right|$.
A pair of vertex sets $\left(V^{1},V^{2}\right)$ is said to be \emph{$\varepsilon$-regular}
if for any $U^{1},U^{2}$ with $U^{\ell}\subseteq V^{\ell}$ and $\left|U^{\ell}\right|\ge\varepsilon\left|V^{\ell}\right|$,
we have $\left|d\left(U^{1},U^{2}\right)-d\left(V^{1},V^{2}\right)\right|\le\varepsilon$.

We will use a bipartite version of the regularity lemma (which can
be deduced from say \cite[Theorem~2.3]{Tao05} in a similar way to
\cite[Theorem~1.10]{KS96}). Let $\alpha'=\alpha/2$ and let $\varepsilon>0$
be a small constant depending on $\alpha$ that will be determined
later (assume for now that $\varepsilon<\alpha/8$). There is a large
constant $K$ depending only on $\alpha$ such that there exist partitions
$A=V_{0}^{1}\cup\dots\cup V_{k}^{1}$ and $B=V_{0}^{2}\cup\dots\cup V_{k}^{2}$
with $k\le K$, in such a way that the following conditions are satisfied.
The ``exceptional'' clusters $V_{0}^{1}$ and $V_{0}^{2}$ both
have fewer than $\varepsilon n$ vertices, and the non-exceptional
clusters in $A$ and $B$ have equal size: $\left|V_{i}^{\ell}\right|=vn$.
There is a subgraph $G'\subseteq G$ with minimum degree at least
$\left(\alpha'+\varepsilon\right)n$ such that each pair of distinct
clusters $V_{i}^{1},V_{j}^{2}$ ($i,j\ge1$) is $\varepsilon$-regular
in $G'$ with density zero or at least $2\varepsilon$.

Define the cluster graph $C$ as the bipartite graph whose vertices
are the non-exceptional clusters $V_{i}^{\ell}$, and whose edges
are the pairs of clusters between which there is nonzero density in
$G'$. The fact that $G$ is dense implies that $C$ is dense as well:
note that in $G'$ each $V_{i}^{\ell}$ has at least $\left(\alpha'+\varepsilon\right)n\left|V_{i}^{\ell}\right|$
edges to other clusters. There are at most $\varepsilon n\left|V_{i}^{\ell}\right|$
edges to the exceptional cluster $V_{0}$ and at most $\left|V_{i}^{1}\right|\left|V_{i}^{2}\right|$
edges to each other cluster. So, $d_{C}\left(V_{i}^{\ell}\right)\ge\left(\left(\alpha'+\varepsilon\right)n-\varepsilon n\right)vn/\left(vn\right)^{2}\ge\alpha'k$
and $C$ has minimum degree at least $\alpha'k$.
\begin{proof}
[Proof of \ref{lem:bipartite-plus-big-matching-perfect}]We use Hall's
marriage theorem: we need to show that a.a.s. $\left|N_{G\cup M}\left(W\right)\right|\ge\left|W\right|$
for all $W\subseteq A$. If $\left|W\right|\le\alpha n$, then $\left|N_{G\cup M}\left(W\right)\right|\ge\left|N_{G}\left(W\right)\right|\ge\alpha n\ge\left|W\right|$
by the degree condition on $G$. Similarly, if $\left|W\right|\ge\left(1-\alpha\right)n$
then every $b\in B$ has an edge to $W$ in $G$, so $\left|N_{G\cup M}\left(W\right)\right|=\left|B\right|\ge\left|W\right|$.
The difficult case is where $\alpha n\le\left|W\right|\le\left(1-\alpha\right)n$. 

Apply our version of the regularity lemma. We first want to prove
that the edges of $M$ a.a.s. ``spread out evenly'' between the
$O\left(1\right)$ clusters. Fix some $V_{i}^{1}$ and $V_{j}^{2}$,
with $i,j\ge1$. The vertices of each $V_{i}^{1}$ are matched by
$M$ to at most $vn$ vertices; conditioning on their number, these
are uniformly randomly chosen from $B$. The number of such vertices
in $V_{j}^{2}$ is then hypergeometrically distributed, so with probability
$1-e^{\Omega\left(n\right)}$ (see for example \cite[Theorem 2.10]{JLR00})
there are at most $\left(v^{2}+\varepsilon\right)n$ edges
of $M$ between $V_{i}^{1}$ and $V_{j}^{2}$. By the union bound, a.a.s.
there are at most $\left(v^{2}+\varepsilon\right)n$ edges
of $M$ between every pair $V_{i}^{1}$, $V_{j}^{2}$. That is, $M$ typically
spreads out evenly between the clusters. We assume this holds for
the remainder of the proof.

Consider any $W\subset A$ with $\alpha n\le\left|W\right|\le\left(1-\alpha\right)n$.
For each $i$ let $\pi_{i}=\left|V_{i}^{1}\cap W\right|/\left(vn\right)$,
and let $D$ be the set of clusters $V_{i}^{1}$ with $\pi_{i}\ge\varepsilon$.
If $\varepsilon$ is small, $D$ must be nonempty. Now, if $V_{j}^{2}\in N_{C}\left(D\right)$
then by $\varepsilon$-regularity there are edges in $G'$ from $W$
to at least $\left(1-\varepsilon\right)vn$ vertices of $V_{j}^{2}$.
It follows that if $\left|N_{C}\left(D\right)\right|=k$ (as would
occur if $G$ was well-distributed) then $\left|N_{G\cup M}\left(W\right)\right|\ge\left|N_{G'}\left(W\right)\right|\ge\left(1-\varepsilon\right)\left(n-\left|V_{0}^{2}\right|\right)\ge\left|W\right|$
for small $\varepsilon$, and we are done.

Otherwise, choose $F\subseteq N\left(D\right)$ with $\left|F\right|=\alpha'k$
and let $S$ contain the vertices in the clusters of $F$. By the
same $\varepsilon$-regularity argument, $\left|N_{G'}\left(W\right)\cap S\right|\ge\alpha'k\left(1-\varepsilon\right)vn\ge\left(1-\varepsilon\right)^{2}\alpha'n$.
Since $\left|M\right|=\left(1-\xi\left(\alpha\right)\right)n$, each
$V_{i}^{1}\cap W$ has at least $\left(\pi_{i}v-\xi\left(\alpha\right)\right)n$
neighbours in $M$, and at most $\alpha'k\left(v^{2}+\varepsilon\right)n$
of these are in $S$. So, 
\begin{align*}
\left|N_{M}\left(W\right)\backslash S\right| & \ge\sum_{V_{i}^{1}\in D}\left(\pi_{i}v-\xi\left(\alpha\right)-\alpha'k\left(v^{2}+\varepsilon\right)\right)n\\
 & \ge\left|W\right|-\varepsilon n-\left|D\right|\left(\xi\left(\alpha\right)+\alpha'k\left(v^{2}+\varepsilon\right)\right)n.
\end{align*}
Since $\left|N_{C}\left(D\right)\right|<k$, there is $V_{j}^{2}$
outside $N_{C}\left(D\right)$, and this $V_{j}^{2}$ must have $\alpha'k$
neighbours outside $D$ in $C$, so $\left|D\right|\le\left(1-\alpha'\right)k$
and therefore $\left|D\right|\alpha'kv^{2}\le\left(1-\alpha'\right)\alpha'$. Since $k=O\left(1\right)$, it follows that
\begin{align*}
\left|N_{G\cup M}\left(W\right)\right| & \ge\left|N_{G'}\left(W\right)\cap S\right|+\left|N_{M}\left(W\right)\backslash S\right|\\
 & \ge\alpha'n+\left|W\right|-\left(1-\alpha'\right)\alpha' n+O\left(\varepsilon+\varepsilon^{2}+\xi\left(\alpha\right)\right)n.
\end{align*}
If $\varepsilon$ is chosen to be small enough relative to $\alpha$
and $\xi\left(\alpha\right)$ chosen to be small enough relative to
$K$, then this gives $\left|N_{G\cup M}\left(W\right)\right|\ge\left|W\right|$.
\end{proof}
Now we describe the reduction of \ref{thm:hypergraph-theorems} to \ref{lem:bipartite-plus-big-matching-perfect}.
Consider a $k$-uniform hypergraph $H$. Suppose $A$ is a set of
$n$ vertices and $B$ is a $\left(k-1\right)$-uniform hypergraph
on the remaining vertices. Then we define a bipartite graph $G_{A,B}\left(H\right)$
as follows. The vertices of $G_{A,B}\left(H\right)$ are the vertices
in $A$, as well as the edges in $B$ (we abuse notation and identify
the hypergraph $B$ with its edge set). We put an edge between $a\in A$
and $\left\{ b_{1},\dots,b_{k-1}\right\} \in B$ if $\left\{ a,b_{1},\dots,b_{k-1}\right\} $
is an edge in $H$.

Each edge in $G_{A,B}\left(H\right)$ corresponds to an edge of $H$. The significance of our definition of $G_{A,B}\left(H\right)$ is that if the hypergraph $B$ is chosen to be a perfect matching (respectively, loose Hamilton cycle) on its vertex set $V\left(H\right)\backslash A$, and if $G_{A,B}\left(H\right)$ has a large matching $M$, then the edges of $M$ correspond to a large matching (respectively, large sub-cycle) in $H$.
Conversely, if $H$ has a large matching or sub-cycle, then there
is a set $A$ and a perfect matching (respectively, loose Hamilton
cycle) $B$ such that $G_{A,B}\left(H\right)$ has a large matching.

For any $\varepsilon>0$, if $\chypmat\left(\alpha\right)$ or $\chypham\left(\alpha\right)$
is large enough, \ref{lem:hypergraph-almost-object} ensures the a.a.s.
existence of a matching or sub-cycle of size $\left(1-\varepsilon\right)n$
in $R$, which means there is an $n$-vertex set $A$ and a perfect matching
or loose Hamilton cycle $B$ on $V\left(A\right)\backslash H$ such that $G_{A,B}\left(R\right)$ contains
a matching of size $\left(1-\varepsilon\right)n$. If there are multiple possible choices for $A$ and $B$, choose one uniformly at random. Since the distribution of $R$ is symmetric with respect to permutations of the vertex set, $A$ is a uniformly random $n$-vertex set and $B$ is a uniformly random perfect matching or Hamilton cycle on the remaining vertices.

We give one final lemma, establishing that $G_{A,B}\left(H\right)$ is a.a.s. dense if $H$ is.
\begin{lem}
\label{lem:hypergraph-bipartite-degree-transfer}There is $\a\left(\alpha\right)>0$ such that the following
holds.

\begin{enumerate}[topsep=0px,label=(\alph*)]

\item{Let $H$ satisfy the conditions of \ref{thm:hypergraph-theorems}(a),
let $A$ be a uniformly random set of $n$ vertices, and let $B$
be a uniformly random perfect matching on $V\left(H\right)\backslash A$.
Then a.a.s. $G_{A,B}\left(H\right)$ has minimum degree $\amat\left(\alpha\right)n$.}

\item{Let $H$ satisfy the conditions of \ref{thm:hypergraph-theorems}(b),
let $A$ be a uniformly random set of $n$ vertices, and let $B$
be a uniformly random loose Hamilton cycle on $V\left(H\right)\backslash A$.
Then a.a.s. $G_{A,B}\left(H\right)$ has minimum degree $\aham\left(\alpha\right)n$.}

\end{enumerate}\end{lem}
\begin{proof}
[Proof of \ref{lem:hypergraph-bipartite-degree-transfer}(a)]It is
helpful to realize the uniform distribution of $A$ and $B$ in a certain way. Let
\[
a_{1},\dots,a_{n},\, b_{1}^{1},\dots,b_{k-1}^{1},\, b_{1}^{2},\dots,b_{k-1}^{n}
\]
be a uniformly random ordering of $V\left(H\right)$. Let $A=\left\{ a_{1},\dots,a_{n}\right\} $,
let $b^{i}=\left\{ b_{1}^{i},\dots,b_{k}^{i}\right\} $ and let $B=\left\{ b^{1},\dots,b^{n}\right\} $.

First, condition on some $b\in B$. Note that $\Pr\left(b\cup\left\{ a_{1}\right\} \in E\left(H\right)\right)\ge\delta_{k-1}\left(H\right)/n$
and more generally
\[
\Pr\left(b\cup\left\{ a_{j+1}\right\} \in E\left(H\right)\mid a_{1},\dots,a_{j}\right)\ge\left(\delta_{k-1}\left(H\right)-j\right)/n\ge\alpha/2
\]
for $j\le\alpha n/2$. By a Chernoff bound, $d_{G_{H}}\left(b\right)\ge\alpha^{2}n/8$
with probability $1-e^{-\Omega\left(n\right)}$. With the union bound,
this a.a.s. holds for all $b$.

Now, $\delta_{1}\left(H\right)\ge\alpha'n^{k-1}$ for some $\alpha'>0$
depending on $\alpha$. Condition on some $a\in A$. Each $b_{j}^{i}$
shares at most ${kn \choose k-2}$ edges with $a_{i}$, so if $j\le2\sqrt{\amat\left(\alpha\right)}n$
for sufficently small $\amat\left(\alpha\right)$ and large $n$,
then
\[
\Pr\left(\left\{ a\right\} \cup b^{j+1}\in E\left(H\right)\mid b^{1},\dots,b^{j}\right)\ge\left(\delta_{1}\left(H\right)-\left(k-1\right)j{kn \choose k-2}\right)\left.\vphantom{\sum}\right/{kn \choose k-1}\ge\sqrt{\amat\left(\alpha\right)}.
\]


By the Chernoff bound and the union bound, a.a.s. each $d_{G_{H}}\left(a\right)\ge\amat\left(\alpha\right)n$.
\end{proof}

\begin{proof}
[Proof of \ref{lem:hypergraph-bipartite-degree-transfer}(b)]We give
essentially the same proof as for \ref{lem:hypergraph-bipartite-degree-transfer}(a).
Choose a uniformly random ordering of $V\left(H\right)$:
\[
a_{1},\dots,a_{n},b_{0},\dots,b_{\left(k-2\right)n-1}.
\]
Let $A=\left\{ a_{1},\dots,a_{n}\right\} $, let $b^{i}=\left\{ b_{\left(k-2\right)i},b_{\left(k-2\right)i+1},\dots,b_{\left(k-2\right)\left(i+1\right)}\right\} $
(where the subscripts are interpreted modulo $\left(k-2\right)n$),
and let $B=\left\{ b^{1},\dots,b^{n}\right\} $.

With exactly the same proof as for \ref{lem:hypergraph-bipartite-degree-transfer}(a),
there is small $\aham\left(\alpha\right)$ such that a.a.s. $d_{G_{H}}\left(b\right)\ge\aham\left(\alpha\right)n$
for all $b\in B$. Next, condition on some $a\in A$. For small $\zeta\left(\alpha\right)$
and $j\le2\sqrt{\aham\left(\alpha\right)}n$,
\[
\Pr\left(\left\{ a\right\} \cup b^{j}\in E\left(H\right)\mid b^{0},\dots,b^{j-1}\right)\ge\left(\delta_{2}\left(H\right)-\left(k-2\right)j{\left(k-1\right)n \choose k-3}\right)\left.\vphantom{\sum}\right/{ \left(k-1\right)n \choose k-2}\ge\sqrt{\aham\left(\alpha\right)},
\]
\

so a.a.s. each $d_{G_{H}}\left(a\right)\ge\aham\left(\alpha\right)n$.
\end{proof}
We have established that if $\chypmat\left(\alpha\right)$ or $\chypham\left(\alpha\right)$
is large enough then $G_{A,B}\left(H\right)$ is a.a.s. a bipartite graph with minimum degree $\a\left(\alpha\right)n$, and $G_{A,B}\left(H\right)$ a.a.s. has a matching $M$ of size $\left(1-\xi\left(\a\left(\alpha\right)\right)\right)n$. If there are multiple possible choices of $M$, choose one uniformly at random. If we condition on $A$ and $B$, then by symmetry $M$ is a uniformly random $\left(1-\xi\left(\a\left(\alpha\right)\right)\right)n$-vertex matching between $A$ and $B$. Then \ref{lem:bipartite-plus-big-matching-perfect}
ensures the existence of a perfect matching in $G_{A,B}\left(H\cup R\right)$. This corresponds to a perfect matching or loose Hamilton cycle in $H\cup R$.


\section{\label{sec:digraphs}Pancyclicity in dense digraphs}

In this section we prove \ref{lem:pseudorandom-pancyclic}, and as
a corollary we also prove the following theorem.
\begin{thm}
\label{thm:smoothed-pancyclic}Let $\DD\left(n,m\right)$ be the uniform
distribution on (not necessarily oriented) $n$-vertex, $m$-arc digraphs.
For each $\alpha>0$, there is $\cdi\left(\alpha\right)$ such that
if $D$ is a digraph with all in- and out- degrees at least $\alpha n$,
and $R\in\DD\left(n,\cdi\left(\alpha\right)n\right)$, then $D\cup R$
is a.a.s. pancyclic.
\end{thm}
One motivation for this theorem is an observation by Bondy (see \cite{Bon75}),
that almost all known non-trivial conditions that ensure Hamiltonicity
also ensure pancyclicity. He made an informal ``metaconjecture''
that this was always the case; our \ref{thm:smoothed-pancyclic} verifies
his metaconjecture in the setting of randomly perturbed dense graphs
and digraphs.

\ref{thm:smoothed-pancyclic} obviously implies \cite[Theorems~1 and~3]{BFM03}.
We do not fight very hard to optimize constants, but we note that
if we make some simplifications in the proof of \ref{thm:smoothed-pancyclic},
the resulting values of $\cdi\left(\alpha\right)$ seem to be better
than those found in \cite{BFM03}, for most values of $\alpha$.

We now turn to the proof of \ref{lem:pseudorandom-pancyclic}, which
will follow from the corresponding result for Hamiltonicity.
\begin{lem}
\label{lem:pseudorandom-hamiltonian}Let $D$ be a directed graph
with all in- and out- degrees at least $4k$, and suppose for all
disjoint $A,B\subseteq V\left(D\right)$ with $\left|A\right|=\left|B\right|\ge k$,
there is an arc from $A$ to $B$. Then $D$ is Hamiltonian.\end{lem}
\begin{rem}
\label{rem:constants}With some effort, the ideas in the proof of
\ref{lem:pseudorandom-hamiltonian} can be used directly to prove
 \ref{lem:pseudorandom-pancyclic} with a weaker degree condition.
We do not know whether the condition can be weakened all the way to
$4k$, as Bondy's metaconjecture would suggest. The constants in \ref{lem:pseudorandom-pancyclic,lem:pseudorandom-hamiltonian}
can both be halved for the undirected case, just by simplifying the
main argument in the proof of \ref{lem:pseudorandom-hamiltonian}.

The idea of the proof is to start with a longest path $P$ and manipulate
it into a cycle $C$ on the same vertex set. We will show that $D$
is strongly connected, so if $C$ were not Hamiltonian, there would
be an arc from $V\left(C\right)$ to its complement, which could be
combined with $C$ to give a longer path than $P$, contradicting
maximality. This type of argument goes back to the proof of Dirac's
theorem \cite[Theorem~3]{Dir52}. It also bears some resemblance to
the ``rotation-extension'' idea introduced in \cite{Pos76}, and
a variation for directed graphs in \cite[Section~4.3]{FK05}.\end{rem}
\begin{proof}
[Proof of \ref{lem:pseudorandom-hamiltonian}]First we acknowledge
some immediate consequences of the condition on $D$. Note that if
$A$ and $B$ are disjoint sets with size at least $k$, then in fact
there are $\left|A\right|-k$ vertices of $A$ with an arc into $B$.
To see this, note that for any fewer number of such vertices in $A$,
we can delete those vertices and at least $k$ will remain, one of
which has an arc to $B$. Also, $D$ is strongly connected. To see
this, note that for any $v,w$, both of $N^{+}\left(v\right)$ and
$N^{-}\left(w\right)$ have size at least $4k>k$. If they intersect
then there is a length-2 path from $v$ to $w$; otherwise there must
be an arc from $N^{+}\left(v\right)$ to $N^{-}\left(w\right)$ giving
a length-3 path.

Let $P=u\dots w$ be a maximal-length directed path in $D$. We will
use the notation $v^{+}$ (respectively $v^{-}$) for the successor
(respectively predecessor) of a vertex $v$ on $P$, and also write
$V^{+},V^{-}$ for the set of successors or predecessors of a set
of vertices $V$.

By maximality, $N^{+}\left(w\right)\subset P$ and $N^{-}\left(u\right)\subset P$.
Let $U_{1}$ be the first $3k$ elements of $N^{-}\left(u\right)$
on $P$, and let $U_{2}$ be the last $k$ (note $U_{1}\cap U_{2}=\varnothing$).
Similarly let $W_{1}$ be the first $k$ and $W_{2}$ the last $3k$
elements of $N^{+}\left(w\right)$. We will now show that there is
a cycle on the vertex set $V\left(P\right)$.

First, consider the case where each vertex of $W_{1}$ precedes each
vertex of $U_{2}$. If $wu$ is in $D$ then we can immediately close
$P$ into a cycle. Otherwise, $\left|W_{1}^{-}\right|=\left|W_{1}\right|=\left|U_{2}^{+}\right|=\left|U_{2}\right|=k$,
so there is an arc $w_{1}u_{2}$ from $W_{1}^{-}$ to $U_{2}^{+}$.
This is enough to piece together a cycle on $V\left(P\right)$: start
at $u_{2}$ and move along $P$ to $w$, from where there is a shortcut
back to $w_{1}^{+}$. Now move along $P$ from $w_{1}^{+}$ to $u_{2}^{-}$,
from where we can jump back to $u$, then move along $P$ to $w_{1}$,
then jump to $u_{2}$. See Figure \ref{fig:pseudorandom-hamiltonian-case-1}
for an illustration.

\begin{figure}[H]
\begin{center}
\hspace{0.5cm}
\begin{tikzpicture}[scale=0.95]

\node[vertex] (u) at  (0,0) {};
\node[vertex] (w1) at  (4.5,0) {};
\node[vertex] (w1p) at  (5,0) {};
\node[vertex] (u2m) at  (10,0) {};
\node[vertex] (u2) at (10.5,0) {};
\node[vertex] (w) at (15.5,0) {};

\draw (u) to (0.5,0);
\draw[arc,dashed] (u) to (w1);
\draw (4,0) to (w1);
\draw (w1) to (w1p);
\draw (w1p) to (5.5,0);
\draw[arc,dashed] (w1p) to (u2m);
\draw (9.5,0) to (u2m);
\draw (u2m) to (u2);
\draw (u2) to (11,0);
\draw[arc,dashed] (u2) to (w);
\draw (15,0) to (w);
\draw[arc] (w) to [bend right] (w1p);
\draw[arc] (u2m)  to [bend right] (u);
\draw[arc] (w1) to [bend right] (u2);

\node at (4.6,-0.5){$w_1^{\phantom+}$};
\node at (5.1,0.5){$w_1^+$};
\node at (10.1,0.5){$u_2^-$};
\node at (10.6,-0.5){$u_2^{\phantom-}$};
\node at (0,-0.5){$u$};
\node at (15.5,-0.5){$w$};

\end{tikzpicture}
\hspace{0.5cm}
\end{center}

\protect\caption{\label{fig:pseudorandom-hamiltonian-case-1}The case where the vertices
of $W_{1}$ precede the vertices of $U_{2}$. The horizontal line
through the center is $P$; the broken lines indicate subpaths.}
\end{figure}


Otherwise, each vertex of $U_{1}$ precedes each vertex of $W_{2}$.
Let $U_{12}$ contain the $k$ elements of $U_{1}$ furthest down
the path. Let $U_{11}$ be the set of vertices among the first $2k$
vertices of $P$ which have an arc to $U_{12}^{+}$. By the discussion
at the beginning of the proof, $\left|U_{11}\right|\ge k$. Similarly,
let $W_{21}$ contain the $k$ elements of $W_{2}$ first appearing
on the path, and let $W_{22}$ be the set of at least $k$ vertices
among the last $2k$ on $P$ which have an arc from $W_{21}^{-}$.
By the condition on $D$, there is an arc $w_{22}u_{11}$ from $W_{22}^{-}$
to $U_{11}^{+}$. By definition, there is $u_{12}\in U_{12}^{+}$
and $w_{21}\in W_{21}^{-}$ such that the arcs $u_{11}^{-}u_{12}$
and $w_{21}w_{22}^{+}$ are in $D$. We can piece everything together
to get a cycle on the vertices of $P$: start at $u_{11}$, move along
$P$ until $u_{12}^{-}$, then jump back to $u$. Move along $P$
until $u_{11}^{-}$, then take the shortcut to $u_{12}$. Continue
along $P$ to $w_{21}$, jump to $w_{22}^{+}$, continue to $w$,
jump back to $w_{21}^{+}$, and continue to $w_{22}$. From here there
is a shortcut back to $u_{11}$. See Figure \ref{fig:pseudorandom-hamiltonian-case-2}.

\begin{figure}[H]
\begin{center}
\hspace{0.5cm}
\begin{tikzpicture}[scale=0.95]

\node[vertex] (u) at  (0,0) {};
\node (up) at  (0.5,0) {};
\node (u11mm) at  (2.5,0) {};
\node[vertex] (u11m) at  (3,0) {};
\node[vertex] (u11) at  (3.5,0) {};
\node[vertex] (u12m) at  (6.5,0) {};
\node[vertex] (u12) at  (7,0) {};
\node[vertex] (w21) at  (10,0) {};
\node[vertex] (w21p) at  (10.5,0) {};
\node[vertex] (w22) at  (13.5,0) {};
\node[vertex] (w22p) at  (14,0) {};
\node[vertex] (w) at  (17,0) {};

\draw (u) to (0.5,0);
\draw[arc,dashed] (u) to (u11m);
\draw (2.5,0) to (u11m);
\draw (u11m) to (u11);
\draw (u11) to (4,0);
\draw[arc,dashed] (u11) to (u12m);
\draw (u12m) to (6,0);
\draw (u12m) to (u12);
\draw (u12) to (7.5,0);
\draw[arc,dashed] (u12) to (w21);
\draw (9.5,0) to (w21);
\draw (w21) to (w21p);
\draw (w21p) to (11,0);
\draw[arc,dashed] (w21p) to (w22);
\draw (13,0) to (w22);
\draw (w22) to (w22p);
\draw (w22p) to (14.5,0);
\draw[arc,dashed] (w22p) to (w);
\draw (16.5,0) to (w);
\draw[arc] (u12m) to [bend right] (u);
\draw[arc] (u11m)  to [bend right] (u12);
\draw[arc] (w21) to [bend right] (w22p);
\draw[arc] (w) to [bend right] (w21p);
\draw[arc] (w22) to [bend right] (u11);

\node at (0,-0.5){$u$};
\node at (3.1,-0.5){$u_{11}^-$};
\node at (3.6,0.5){$u_{11}^{\phantom-}$};
\node at (6.6,0.5){$u_{12}^-$};
\node at (7.1,-0.5){$u_{12}^{\phantom-}$};
\node at (10.1,-0.5){$w_{21}^{\phantom+}$};
\node at (10.6,0.5){$w_{21}^+$};
\node at (13.6,0.5){$w_{22}^{\phantom+}$};
\node at (14.1,-0.5){$w_{22}^+$};
\node at (17,-0.5){$w$};

\end{tikzpicture}
\hspace{0.5cm}
\end{center}

\protect\caption{\label{fig:pseudorandom-hamiltonian-case-2}The case where the vertices
of $U_{1}$ precede the vertices of $W_{2}$.}
\end{figure}


As outlined, the fact that $D$ is strongly connected, combined with
the fact that the vertex set of $P$ induces a cycle $C$, implies
that $C$ is a Hamilton cycle.
\end{proof}

\begin{proof}
[Proof of \ref{lem:pseudorandom-hamiltonian}]Fix a vertex $v$. Let
$U^{+}$ and $U^{-}$ be arbitrary $k$-subsets of $N^{+}\left(v\right)$
and $N^{-}\left(v\right)$ respectively. There is an arc from $U^{+}$
to $U^{-}$ which immediately gives a 3-cycle.

Next, let $W^{+}$ be the set of (fewer than $k$) vertices with no
arc into $U^{+}$, and similarly let $W^{-}$ be the set of vertices
with no arc from $U^{-}$. Now consider the induced digraph $D'$
obtained from $D$ by deleting $v$ and the vertices in $U^{+},U^{-},W^{+},W^{-}$.
Since we have removed fewer than $4k$ vertices, $D'$ satisfies the
conditions of \ref{lem:pseudorandom-hamiltonian} so has a Hamilton
cycle. In particular, for every $\ell$ satisfying $4\le\ell\le n-4k$,
there is a path $P_{\ell}=u_{\ell}\dots w_{\ell}$ in $D'$ of length
$\ell-4$. By construction, there is an arc from $U^{+}$ to $u_{\ell}$
and from $w_{\ell}$ to $U^{-}$, which we can combine with arcs to
and from $v$ to get a cycle of length $\ell$.

Finally, for every $\ell>n-4k$, arbitrarily delete vertices from
$D$ to obtain an induced digraph $D''$ with $\ell$ vertices which
satisfies the conditions of \ref{lem:pseudorandom-hamiltonian}. Since
$D''$ has a Hamilton cycle, $D$ has a cycle of length $\ell$.
\end{proof}

\begin{proof}
[Proof of \ref{thm:smoothed-pancyclic}]In view of the discussion
in the introduction, we assume each possible arc is present in $R$
with independent probability $p=2\cdi\left(\alpha\right)/n$.

If $A,B\subseteq V\left(D\right)$ are disjoint sets with $\left|A\right|=\left|B\right|=\alpha n/8$,
the probability that there are no arcs from $A$ to $B$ in $D\cup R$
is at most
\[
\left(1-p\right)^{\left(\alpha n/8\right)^{2}}\le e^{-p\alpha^{2}n^{2}/64}=e^{-\cdi\left(\alpha\right)\alpha^{2}n/32}.
\]
The number of choices of such pairs of disjoint sets $A,B$ is
\[
{n \choose \alpha n/4}{\alpha n/4 \choose \alpha n/8}=O\left(\frac{1}{\sqrt{n}}e^{n\left(H\left(\alpha/4\right)+\alpha H\left(1/2\right)/4\right)}\right),
\]
where $H\left(\alpha\right)=-\alpha\log\alpha-\left(1-\alpha\right)\log\left(1-\alpha\right)$
(this can be proved with Stirling's approximation). By a union bound,
the probability that $D\cup R$ does not satisfy the condition of
\ref{lem:pseudorandom-hamiltonian} is at most
\[
O\left(\frac{1}{\sqrt{n}}e^{n\left(H\left(\alpha/4\right)+\alpha H\left(1/2\right)/4-\cdi\left(\alpha\right)\alpha^{2}n/32+o\left(1\right)\right)}\right).
\]
This converges to zero if $\cdi\left(\alpha\right)$ is chosen to
be sufficiently large.\end{proof}
\begin{rem}
If we are only interested in Hamiltonicity, we can use \ref{lem:pseudorandom-hamiltonian}
directly in the proof of \ref{thm:smoothed-pancyclic}, which gives
a better constant $\cdi\left(\alpha\right)$ than in \cite[Theorem~3]{BFM03},
for all $\alpha$. If we make the adjustment for undirected graphs
mentioned in \ref{rem:constants}, then we also beat the corresponding
constant in \cite[Theorem~1]{BFM03} except for small values of $\alpha$.
\end{rem}

\section{\label{sec:tournaments}Hamilton cycles in tournaments}

There are several seemingly different conditions that are equivalent
to Hamiltonicity for tournaments (see \cite[Chapters~2-3]{Moo68}).
A tournament is Hamiltonian if and only if it is irreducible (cannot
be divided into two partitions with all arcs between the two partitions
in the same direction), if and only if it is strongly connected (has
a directed path from every vertex to every other), if and only if
it is pancyclic (contains cycles of all lengths). All tournaments
have a Hamilton path, and it was first proved in \cite{MM62} that
a uniformly random tournament is a.a.s. irreducible, hence Hamiltonian.

It was more recently proved in \cite{KLOP14} that if a tournament
is $t$-strongly connected (it remains strongly connected after the
deletion of $t-1$ vertices), then it has $\Omega\left(\sqrt{t}/\log t\right)$
arc-disjoint Hamilton cycles (this was improved to $\Omega\left(\sqrt{t}\right)$
in \cite{Pok14}). It is not difficult to show that a random tournament
is a.a.s. $t$-connected for fixed $t$, which implies that a random
tournament contains $q$ arc-disjoint Hamilton cycles for $q=O\left(1\right)$.
We will use this to prove \ref{thm:tournament}.

Before we proceed to the proof, we first explain why \ref{thm:tournament}
is sharp. The ``obvious'' worst case for $T$ is a \emph{transitive}
tournament (corresponding to a linear order on the vertices). In this
case, a superlinear number of edges must be flipped in order to a.a.s.
flip one of the arcs pointing away from the least element of the linear
order. Actually, the model where random edges are flipped in a transitive
tournament has already been studied in \cite{LRG96}, by analogy to
the evolution of the random graph.

More generally, consider a ``transitive cluster-tournament'' $T$
on $n=rk$ vertices defined as follows. Let $R$ be a regular tournament
on $2d+1$ vertices (this means the indegree and outdegree are equal
for each vertex). To construct $T$, start with $r$ disjoint copies
$R_{1},\dots,R_{r}$ of $R$, then put an arc from $v$ to $w$ for
every $v\in R_{i}$, $w\in R_{j}$ with $i<j$. In order for the perturbed
tournament $P$ to be Hamiltonian, there must be an arc entering $R_{1}$,
so one of the $O\left(n\left(d+1\right)\right)$ arcs exiting $R_{1}$
must be changed. This will not happen a.a.s. unless $m=\omega\left(d+1\right)/n$.

We now prove \ref{thm:tournament}. In accordance with the discussion
in the introduction, we will work with the model where each edge is
flipped with independent probability $p$, where $2p{n \choose 2}=m$.
(Designating an edge for resampling with probability $2p$ is the
same as flipping it with probability $p$).

Fix $t$; we will prove that $P$ is $t$-strongly connected. The
idea of the proof is to choose a set $S$ of $t$ vertices with a
large indegree and outdegree, then show that with high probability
almost every vertex has many paths to and from each vertex in $S$.
The probability that a vertex $v$ has paths from $S$ is smallest
if $v$ has small indegree, so we need to show that not many vertices
can have small indegree.
\begin{lem}
\label{lem:extreme-indegree-bound}In any tournament, there are less
than $k$ vertices with indegree (respectively outdegree) less than
$\left(k-1\right)/2$.\end{lem}
\begin{proof}
The sum of indegrees (respectively outdegrees) of a tournament on
$k$ vertices is ${k \choose 2}$, because each arc contributes 1
to this sum. Therefore in every set of $k$ vertices of a tournament,
there is a vertex of outdegree (indegree) at least $\left(k-1\right)/2$
in the induced tournament.
\end{proof}
A consequence of \ref{lem:extreme-indegree-bound} is that the set
of all vertices with indegree (respectively outdegree) less than $n/6$
has size smaller than $n/3$. So, there are at least $n/3$ vertices
with indegree and outdegree at least $n/6$. We can therefore choose
a set $S$ of $t$ such vertices.

Now, we prove that the random perturbation does not change the in-
and -out degrees very much.
\begin{lem}
\label{lem:preserve-degree}If a vertex $v$ has outdegree (respectively
indegree) $k$ in $T$, then it has outdegree (respectively indegree)
at least $k/3$ in $P$, with probability $e^{-\Omega\left(\sqrt{n}\right)}$
uniformly over $k$.\end{lem}
\begin{proof}
We only prove the statement where $v$ has outdegree $k$; the indegree
case is identical. If $k=0$ the lemma is trivial, so assume $k\ge1$.
First consider the cases where $k>\sqrt{n}$ or $p<1/\sqrt{n}$. There
are $k$ arcs pointing away from $v$ in $T$, and a Cherhoff bound
says that the probability more than $2k/3$ arcs are changed by the
perturbation is
\[
e^{-\Omega\left(k^{2}/\E X\right)}=e^{-\Omega\left(\sqrt{n}\right)}.
\]
That is, with the required probability, $k/3$ of the original out-neighbours
survive the perturbation.

Otherwise (for large $n$), there is a set of $n/2$ arcs pointing
towards $v$ in $T$. A Chernoff bound says that the probability less
than $k/3$ of these arcs are changed is $e^{-\Omega\left(\sqrt{n}\right)}$.
That is, with the required probability, $k/3$ new out-neighbours
are added by the perturbation.\end{proof}
\begin{lem}
\label{lem:path-from-home}Suppose $w$ has outdegree (respectively
indegree) at least $n/6$, and $v\ne w$ is a vertex with indegree
(respectively outdegree) at least $k$. Then with probability $1-e^{-\Omega\left(\sqrt{n}\right)}-e^{-\Omega\left(np\left(k+1\right)\right)}$
(uniformly over $k$), there are $t'=3t$ internally vertex-disjoint
paths of length at most 3 from $w$ to $v$ (respectively from $v$
to $w$).\end{lem}
\begin{proof}
We will only prove the statement where $v$ has indegree at least
$k$; the outdegree case is identical. By independence, we can condition
on the outcome of the perturbation on individual arcs. Condition on
the outcome for all arcs adjacent to $w$, and let $N_{P}^{+}\left(w\right)$
be the set of vertices to which there is an arc from $w$ in $P$.
By \ref{lem:preserve-degree}, we can assume $\left|N_{P}^{+}\left(w\right)\right|\ge n/18$.

We first prove the lemma for the case where $k\le12t'$. There are
at least $n'=n/18-1$ arcs between $N_{P}^{+}\left(w\right)$ and
$v$, each of which will be pointing towards $v$ in $P$ with independent
probability at least $p$. By a Chernoff bound, the probability less
than $t'$ arcs will point from $N_{P}^{+}\left(w\right)$ to $v$
in $P$ is
\[
e^{-\Omega\left(\E Z-t'\right)}=e^{-\Omega\left(np\right)}=e^{-\Omega\left(np\left(k+1\right)\right)}.
\]
So, with the required probability there are $t'$ suitable length-2
paths from $w$ to $v$.

We can now assume $k>12t'$. Condition on the result of the perturbation
for the arcs adjacent to $v$ (in addition to the arcs we have conditioned
on so far). Let $N_{P}^{-}\left(v\right)$ be the set of vertices
from which there is an edge into $v$ in $P$; by \ref{lem:preserve-degree},
we can assume $\left|N_{P}^{-}\left(v\right)\right|\ge k/3$.

Now, if $\left|N_{P}^{+}\left(w\right)\cap N_{P}^{-}\left(v\right)\right|\ge t'$
then there are $t'$ disjoint length-2 paths from $w$ to $v$ and
we are done. So we can assume $U^{+}=N_{P}^{+}\left(w\right)\backslash\left(N_{P}^{-}\left(v\right)\cup\left\{ v\right\} \right)$
has at least $n'=n/18-t'-1$ vertices, and $U^{-}=N_{P}^{-}\left(v\right)\backslash\left(N_{P}^{+}\left(w\right)\cup\left\{ w\right\} \right)$
has at least $k'=k/6-t'-1$ vertices (note $k'\ge t'$ by assumption).

Now, we would like to show that with the required probability there
is a set of $t'$ independent arcs from $U^{+}$ into $U^{-}$ in
$P$, which will give $t'$ suitable length-3 paths. Partition $U^{+}$(respectively
$U^{-}$) into subsets $U_{1}^{+},\dots,U_{t'}^{+}$ (respectively
$U_{1}^{-},\dots,U_{t'}^{-}$), such that each $\left|U_{1}^{+}\right|>n'/\left(2t'\right)$
and each $\left|U_{1}^{-}\right|>k'/\left(2t'\right)$. For each $i$,
the probability that there is no arc from $U_{i}^{+}$ into $U_{i}^{-}$
after the perturbation is at most
\[
\left(1-p/2\right)^{n'k'/\left(4t'\right)}\le e^{-\Theta\left(np\left(k+1\right)\right)},
\]
so with the required probability there a set of $t'$ suitable independent
arcs, each between a pair $U_{i}^{+},U_{i}^{-}$.\end{proof}
\begin{lem}
\label{lem:lots-of-paths}Fix some $w\in S$. In $P$, there are a.a.s.
$t$ disjoint paths from $w$ to each other vertex (respectively,
from each other vertex to $w$).\end{lem}
\begin{proof}
We only prove there are paths from $w$ to each other vertex; the
reverse case is identical. If there are $3t$ disjoint paths of length
at most 3 from $w$ to $v$ then we say $v$ is \emph{safe}. It follows
from \ref{lem:path-from-home} that a vertex with indegree $k$ is
safe with probability $1-e^{-\Omega\left(\sqrt{n}\right)}-e^{-\Omega\left(np\left(k+1\right)\right)}$.

By \ref{lem:extreme-indegree-bound}, there are at most $\left(2d+1\right)$
vertices with outdegree $d$, and the vertex with the $2k$th smallest
outdegree has outdegree at least $k-1$. Let $Q$ be the set of non-safe
vertices, and note
\begin{align*}
\E\left|Q\right| & =\left(2d+1\right)e^{-\Omega\left(np\left(d+1\right)\right)}+\sum_{k=d+1}^{n}2e^{-\Omega\left(np\left(k+1\right)\right)}+ne^{-\Omega\left(\sqrt{n}\right)}\\
 & =e^{-\Omega\left(np\left(d+1\right)\right)}\left(O\left(d+1\right)+\frac{1}{1-e^{-\Omega\left(np\right)}}\right)+o\left(1\right)\\
 & =e^{-\Omega\left(np\left(d+1\right)\right)}O\left(d+1\right).
\end{align*}
where we have used the geometric series formula, the inequality $1-e^{-x}\ge\left(x\land1\right)/2$
(for positive $x$) and the fact that $d+1=\Omega\left(1\right)$.

By Markov's inequality, a.a.s. $\left|Q\right|\le\sqrt{e^{-\Omega\left(pn\left(d+1\right)\right)}}O\left(d+1\right)=o\left(d+1\right)$.
If $d\le4t$ then $\left|Q\right|=0$ for large $n$. Otherwise, for
large $n$, $\left|Q\right|\le3d$, so every vertex $v\in Q$ has
$3t$ safe neighbours $v_{1},\dots,v_{3t}$. Now, fix a maximal set
$M$ of disjoint paths from $w$ to $v$. If $\left|M\right|<t$ then
the paths in $M$ collectively use less than $3t$ vertices other
than $t$, so there is some $v_{i}$ not in any path of $M$, and
there is some path from $w$ to $v_{i}$ that does not contain any
vertex of $M$. But then $w\dots v_{i}v$ is a path from $w$ to $v$
disjoint with every path in $M$, contradicting maximality.
\end{proof}
It follows from \ref{lem:lots-of-paths} that a.a.s. every vertex
outside $S$ has $t$ disjoint paths to and from every vertex in $S$.
If we delete $t-1$ vertices, then there is at least one vertex $w$
of $S$ remaining, and $w$ has least one path to and from every other
vertex. That is, $P$ is strongly connected. (In fact, we have also
proved that $P$ has diameter at most 8).


\section{Concluding Remarks}

We have determined the amount of random perturbation required to make
a tournament, dense digraph or dense uniform hypergraph Hamiltonian. In
the process, we have proved a general lemma about pancyclicity in
highly connected digraphs, and demonstrated an interesting application
of the Szemer\'edi regularity lemma. There are a few important questions
this paper leaves open.

First, we have only studied loose Hamiltonicity. The other most popular
notion of a hypergraph cycle is a \emph{tight} cycle, in which every
consecutive pair of edges in the cycle intersects in $k-1$ vertices.
More generally, an $\ell$-cycle has consecutive edges intersecting
in $k-\ell$ vertices. Also, we have only studied hypergraphs with
high $\left(k-1\right)$-degree, which is the strongest density assumption
we could make. There are a large variety of Dirac-type theorems for
different types of minimum degree and different types of cycles (see
\cite{RR10} for a survey), which would suggest that similar random
perturbation results are possible in these settings. In addition,
it is possible that our use of Szemer\'edi's regularity lemma could
be avoided, thereby drastically improving the constants $\chypham\left(\alpha\right)$
and $\chypmat\left(\alpha\right)$.

\bibliographystyle{amsplain}
\providecommand{\bysame}{\leavevmode\hbox to3em{\hrulefill}\thinspace}
\providecommand{\MR}{\relax\ifhmode\unskip\space\fi MR }
% \MRhref is called by the amsart/book/proc definition of \MR.
\providecommand{\MRhref}[2]{%
  \href{http://www.ams.org/mathscinet-getitem?mr=#1}{#2}
}
\providecommand{\href}[2]{#2}
\begin{thebibliography}{10}

\bibitem{BHM04}
Tom Bohman, Alan Frieze, Michael Krivelevich, and Ryan Martin, \emph{Adding
  random edges to dense graphs}, Random Structures \& Algorithms \textbf{24}
  (2004), no.~2, 105--117.

\bibitem{BFM03}
Tom Bohman, Alan Frieze, and Ryan Martin, \emph{How many random edges make a
  dense graph {H}amiltonian?}, Random Structures \& Algorithms \textbf{22}
  (2003), no.~1, 33--42.

\bibitem{Bon75}
JA~Bondy, \emph{Pancyclic graphs: Recent results}, Infinite and finite sets: to
  {P}aul {E}rd\H{o}s on his 60th birthday, Volume 1 (A~Hajnal, R~Rado, and
  Vera~T Sos, eds.), Colloquia mathematica Societatis J\'anos Bolyai, vol.~10,
  North-Holland Publishing Company, Amsterdam-London, 1975, pp.~181--187.

\bibitem{Dir52}
Gabriel~Andrew Dirac, \emph{Some theorems on abstract graphs}, Proceedings of
  the London Mathematical Society \textbf{3} (1952), no.~1, 69--81.

\bibitem{DF11}
Andrzej Dudek and Alan Frieze, \emph{Loose {H}amilton cycles in random uniform
  hypergraphs}, Electronic Journal of Combinatorics \textbf{18} (2011), no.~1,
  Paper 48.

\bibitem{FK05}
Alan Frieze and Michael Krivelevich, \emph{On packing {H}amilton cycles in
  $\varepsilon$-regular graphs}, Journal of Combinatorial Theory, Series B
  \textbf{94} (2005), no.~1, 159--172.

\bibitem{JLR00}
Svante Janson, Tomasz {\L{}}uczak, and Andrzej Ruci{\'n}ski, \emph{Random
  graphs}, Cambridge University Press, 2000.

\bibitem{JKV08}
Anders Johansson, Jeff Kahn, and Van Vu, \emph{Factors in random graphs},
  Random Structures \& Algorithms \textbf{33} (2008), no.~1, 1--28.

\bibitem{Kar72}
R~M Karp, \emph{Reducibility among combinatorial problems}, Complexity of
  Computer Computations (R~E Miller and J~W Thatcher, eds.), vol.~10, Plenum,
  New York, 1972, pp.~85--104.

\bibitem{KKMO11}
Peter Keevash, Daniela K{\"u}hn, Richard Mycroft, and Deryk Osthus, \emph{Loose
  {H}amilton cycles in hypergraphs}, Discrete Mathematics \textbf{311} (2011),
  no.~7, 544--559.

\bibitem{KS96}
J~Koml\'os and M~Simonovits, \emph{Szemer\'edi's regularity lemma and its
  applications in graph theory}, Combinatorics, {P}aul {E}rd\H{o}s is eighty
  (D~Mikl\'os, VT~Sos, and T~Szonyi, eds.), Bolyai society mathematical
  studies, vol.~2, J\'anos {B}olyai Mathematical Society, Budapest, 1996,
  pp.~295--352.

\bibitem{KST06}
Michael Krivelevich, Benny Sudakov, and Prasad Tetali, \emph{On smoothed
  analysis in dense graphs and formulas}, Random Structures \& Algorithms
  \textbf{29} (2006), no.~2, 180--193.

\bibitem{KLOP14}
Daniela K{\"u}hn, John Lapinskas, Deryk Osthus, and Viresh Patel, \emph{Proof
  of a conjecture of {T}homassen on {H}amilton cycles in highly connected
  tournaments}, Proceedings of the London Mathematical Society (2014), pdu019.

\bibitem{LRG96}
Tomasz {\L}uczak, Andrzej Ruci{\'n}ski, and Jacek Gruszka, \emph{On the
  evolution of a random tournament}, Discrete Mathematics \textbf{148} (1996),
  no.~1, 311--316.

\bibitem{Moo68}
JW~Moon, \emph{Topics on tournaments}, Holt, Rinehart and Winston, 1968.

\bibitem{MM62}
JW~Moon and L~Moser, \emph{Almost all tournaments are irreducible}, Canadian
  Mathematical Bulletin \textbf{5} (1962), 61--65.

\bibitem{Pok14}
Alexey Pokrovskiy, \emph{Edge disjoint {H}amiltonian cycles in highly connected
  tournaments}, arXiv preprint arXiv:1406.7556 (2014).

\bibitem{Pos76}
L~P{\'o}sa, \emph{{H}amiltonian circuits in random graphs}, Discrete
  Mathematics \textbf{14} (1976), no.~4, 359--364.

\bibitem{RR10}
Vojtech R{\"o}dl and Andrzej Ruci{\'n}ski, \emph{Dirac-type questions for
  hypergraphs -- a survey (or more problems for {E}ndre to solve)}, An
  Irregular Mind: Szemer\'edi is 70 (Imre B\'arany and J\'ozsef Solymosi,
  eds.), Bolyai Society Mathematical Studies, vol.~21, Springer and J\'anos
  Bolyai Mathematical Society, New York and Budapest, 2010, pp.~561--590.

\bibitem{ST03}
Daniel~A Spielman and Shang-Hua Teng, \emph{Smoothed analysis: Motivation and
  discrete models}, Algorithms and data structures: 8th International Workshop,
  WADS 2003, Ottawa, Ontario, Canada, July 30 - August 1, 2003, Proceedings
  (Frank Dehne, J{\"o}rg~R{\"u}diger Sack, and Michie Smid, eds.), Lecture
  Notes in Computer Science, vol. 2748, Springer, 2003, pp.~256--270.

\bibitem{ST04}
\bysame, \emph{Smoothed analysis of algorithms: Why the simplex algorithm
  usually takes polynomial time}, Journal of the ACM \textbf{51} (2004), no.~3,
  385--463.

\bibitem{Tao05}
Terence Tao, \emph{Szemer\'edi's regularity lemma revisited}, Contributions to
  Discrete Mathematics \textbf{1} (2006), no.~1, 8--28.

\end{thebibliography}

\end{document}
